<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>UTC Hack — Zulu Time Converter for Pilots & Aviation</title>

  <!-- SEO Meta Tags -->
  <meta name="description" content="Free UTC/Zulu time converter for pilots and aviation professionals. Convert between Zulu time and local time for any city. Perfect for flight planning, METAR/TAF interpretation, and international operations.">
  <meta name="keywords" content="UTC, Zulu time, pilot, aviation, flight planning, timezone converter, GMT, METAR, TAF, world clock, DST, ATC, international flights">
  <link rel="canonical" href="https://utchack.com/">

  <!-- Hreflang tags for international SEO -->
  <link rel="alternate" hreflang="en" href="https://utchack.com/">
  <link rel="alternate" hreflang="de" href="https://utchack.com/de/">
  <link rel="alternate" hreflang="fr" href="https://utchack.com/fr/">
  <link rel="alternate" hreflang="es" href="https://utchack.com/es/">
  <link rel="alternate" hreflang="pt" href="https://utchack.com/pt/">
  <link rel="alternate" hreflang="it" href="https://utchack.com/it/">
  <link rel="alternate" hreflang="pl" href="https://utchack.com/pl/">
  <link rel="alternate" hreflang="nl" href="https://utchack.com/nl/">
  <link rel="alternate" hreflang="ru" href="https://utchack.com/ru/">
  <link rel="alternate" hreflang="ja" href="https://utchack.com/ja/">
  <link rel="alternate" hreflang="zh" href="https://utchack.com/zh/">
  <link rel="alternate" hreflang="ko" href="https://utchack.com/ko/">
  <link rel="alternate" hreflang="ar" href="https://utchack.com/ar/">
  <link rel="alternate" hreflang="x-default" href="https://utchack.com/">

  <!-- Open Graph / Social Sharing -->
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://utchack.com/">
  <meta property="og:title" content="UTC Hack — Zulu Time Converter for Pilots">
  <meta property="og:description" content="Free UTC/Zulu time converter for pilots and aviation. Convert between Zulu and local time for any city worldwide.">
  <meta property="og:image" content="https://utchack.com/icon-512.png">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="UTC Hack — Zulu Time Converter for Pilots">
  <meta name="twitter:description" content="Free UTC/Zulu time converter for pilots and aviation.">

  <!-- Structured Data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "UTC Hack - Zulu Time Converter",
    "url": "https://utchack.com",
    "description": "Free UTC/Zulu time converter for pilots and aviation professionals. Convert between Zulu time and local time for flight planning, METAR interpretation, and international operations.",
    "applicationCategory": "UtilityApplication",
    "keywords": "Zulu time, UTC, pilot, aviation, flight planning, timezone",
    "audience": {
      "@type": "Audience",
      "audienceType": "Pilots, Aviation Professionals, Flight Dispatchers"
    },
    "operatingSystem": "Any",
    "offers": {
      "@type": "Offer",
      "price": "0",
      "priceCurrency": "USD"
    }
  }
  </script>

  <!-- PWA Meta Tags -->
  <meta name="application-name" content="UTC Hack">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="UTC Hack">
  <meta name="theme-color" content="#c45c3e">

  <!-- Icons -->
  <link rel="icon" type="image/svg+xml" href="/icon.svg">
  <link rel="apple-touch-icon" href="/icon-180.png">
  <link rel="manifest" href="/manifest.json">
  <style>
    :root {
      /* Frank Lloyd Wright Prairie Style - Light Theme */
      --bg-primary: #f5f0e6;
      --bg-secondary: #ebe4d4;
      --bg-card: #fff8ee;
      --text-primary: #2c2416;
      --text-secondary: #5c4d3a;
      --text-muted: #8b7d6b;
      --accent-terracotta: #c45c3e;
      --accent-gold: #c9a227;
      --accent-sage: #7a8b6e;
      --accent-brown: #6b4423;
      --border-color: #d4c9b5;
      --border-strong: #b8a88a;
      --shadow: rgba(44, 36, 22, 0.1);
      --geometric-line: #c45c3e;
      --leadwork: rgba(107, 68, 35, 0.35);
    }

    [data-theme="dark"] {
      --bg-primary: #1a1612;
      --bg-secondary: #2a241c;
      --bg-card: #322a20;
      --text-primary: #f0e8d8;
      --text-secondary: #c9bda8;
      --text-muted: #8b7d6b;
      --accent-terracotta: #e07050;
      --accent-gold: #ddb84a;
      --accent-sage: #9aab8e;
      --accent-brown: #a67c52;
      --border-color: #4a4035;
      --border-strong: #6b5d4a;
      --shadow: rgba(0, 0, 0, 0.3);
      --geometric-line: #e07050;
      --leadwork: rgba(180, 160, 130, 0.5);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', 'Helvetica Neue', Arial, sans-serif;
      background-color: var(--bg-primary);
      color: var(--text-primary);
      min-height: 100vh;
      line-height: 1.6;
      transition: background-color 0.3s, color 0.3s;
    }

    /* FLW Geometric Header Band - subtle */
    .header-band {
      background: var(--accent-brown);
      height: 3px;
      position: relative;
    }

    .header-band::after {
      content: '';
      position: absolute;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 60px;
      height: 3px;
      background: var(--accent-gold);
    }

    .container {
      max-width: 720px;
      margin: 0 auto;
      padding: 2rem 1.5rem;
      position: relative;
    }

    /* Subtle FLW-inspired vertical leadwork borders */
    .container::before,
    .container::after {
      content: '';
      position: fixed;
      top: 0;
      bottom: 0;
      width: 20px;
      pointer-events: none;
      opacity: 0.7;
      background:
        /* Thin vertical lines */
        linear-gradient(90deg,
          transparent 0px,
          transparent 8px,
          var(--leadwork) 8px,
          var(--leadwork) 9px,
          transparent 9px,
          transparent 11px,
          var(--leadwork) 11px,
          var(--leadwork) 12px,
          transparent 12px
        ),
        /* Small diamond accents */
        repeating-linear-gradient(180deg,
          transparent 0px,
          transparent 80px,
          var(--leadwork) 80px,
          transparent 84px,
          transparent 88px
        );
    }

    .container::before {
      left: 0;
    }

    .container::after {
      right: 0;
      transform: scaleX(-1);
    }

    @media (max-width: 800px) {
      .container::before,
      .container::after {
        display: none;
      }
    }

    /* Header with horizontal emphasis */
    header {
      text-align: center;
      margin-bottom: 2rem;
      position: relative;
    }

    header::after {
      content: '';
      display: block;
      width: 200px;
      height: 3px;
      background: var(--accent-terracotta);
      margin: 1rem auto 0;
    }

    h1 {
      font-size: 1.8rem;
      font-weight: 400;
      letter-spacing: 0.15em;
      text-transform: uppercase;
      color: var(--text-primary);
    }

    .subtitle {
      color: var(--text-muted);
      font-size: 0.9rem;
      margin-top: 0.5rem;
      letter-spacing: 0.05em;
    }

    /* Theme Toggle - FLW style */
    .theme-toggle {
      background: transparent;
      border: 1px solid var(--border-color);
      padding: 0.5rem 1.25rem;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      color: var(--text-muted);
      transition: all 0.2s;
      position: relative;
    }

    .theme-toggle::before,
    .theme-toggle::after {
      content: '';
      position: absolute;
      width: 8px;
      height: 8px;
      border: 1px solid var(--accent-gold);
      opacity: 0.6;
    }

    .theme-toggle::before {
      top: -1px;
      left: -1px;
      border-right: none;
      border-bottom: none;
    }

    .theme-toggle::after {
      bottom: -1px;
      right: -1px;
      border-left: none;
      border-top: none;
    }

    .theme-toggle:hover {
      border-color: var(--accent-gold);
      color: var(--text-secondary);
    }

    /* Live Clocks - Horizontal Strip */
    .clocks-strip {
      display: flex;
      justify-content: center;
      gap: 3rem;
      padding: 1.5rem;
      background: var(--bg-secondary);
      border-top: 1px solid var(--border-color);
      border-bottom: 1px solid var(--border-color);
      margin-bottom: 2rem;
      position: relative;
    }

    /* Subtle horizontal line accents */
    .clocks-strip::before,
    .clocks-strip::after {
      content: '';
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
      width: 120px;
      height: 1px;
      background: linear-gradient(90deg,
        transparent 0%,
        var(--leadwork) 20%,
        var(--leadwork) 80%,
        transparent 100%
      );
    }

    .clocks-strip::before {
      top: 4px;
    }

    .clocks-strip::after {
      bottom: 4px;
    }

    .clock-item {
      text-align: center;
    }

    .clock-label {
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.15em;
      color: var(--text-muted);
      margin-bottom: 0.25rem;
    }

    .clock-time {
      font-size: 1.5rem;
      font-weight: 300;
      font-family: 'SF Mono', 'Consolas', monospace;
      color: var(--accent-terracotta);
    }

    .clock-item.local .clock-time {
      color: var(--accent-sage);
    }

    /* Main Card */
    .card {
      background: var(--bg-card);
      border: 1px solid var(--border-strong);
      padding: 2rem;
      position: relative;
    }

    /* FLW-style corner accents - like window leading */
    .card::before,
    .card::after {
      content: '';
      position: absolute;
      pointer-events: none;
    }

    .card::before {
      top: 10px;
      left: 10px;
      width: 45px;
      height: 45px;
      border-left: 2px solid var(--accent-gold);
      border-top: 2px solid var(--accent-gold);
      opacity: 0.7;
    }

    .card::after {
      bottom: 10px;
      right: 10px;
      width: 45px;
      height: 45px;
      border-right: 2px solid var(--accent-gold);
      border-bottom: 2px solid var(--accent-gold);
      opacity: 0.7;
    }

    /* Small squares at corner bracket ends */
    .card-corner-tl,
    .card-corner-br {
      position: absolute;
      width: 6px;
      height: 6px;
      background: var(--accent-gold);
      opacity: 0.7;
    }

    .card-corner-tl {
      top: 10px;
      left: 10px;
    }

    .card-corner-br {
      bottom: 10px;
      right: 10px;
    }

    .card-title {
      font-size: 1.1rem;
      font-weight: 400;
      text-transform: uppercase;
      letter-spacing: 0.15em;
      color: var(--text-secondary);
      text-align: center;
      margin-bottom: 1.5rem;
      padding-bottom: 1rem;
      border-bottom: 1px solid var(--border-color);
    }

    /* Direction Toggle */
    .direction-toggle {
      display: flex;
      margin-bottom: 2rem;
      border: 1px solid var(--border-color);
      border-radius: 0;
    }

    .direction-btn {
      flex: 1;
      padding: 1rem;
      background: var(--bg-secondary);
      border: none;
      cursor: pointer;
      font-size: 0.85rem;
      color: var(--text-secondary);
      transition: all 0.2s;
      text-transform: uppercase;
      letter-spacing: 0.1em;
    }

    .direction-btn:first-child {
      border-right: 1px solid var(--border-color);
    }

    .direction-btn.active {
      background: var(--accent-terracotta);
      color: white;
    }

    .direction-btn:hover:not(.active) {
      background: var(--bg-primary);
    }

    /* Form Steps */
    .step {
      margin-bottom: 1.5rem;
    }

    .step-header {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      margin-bottom: 0.75rem;
    }

    .step-number {
      width: 28px;
      height: 28px;
      background: var(--accent-terracotta);
      color: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.85rem;
      font-weight: 600;
    }

    .step-label {
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      color: var(--text-secondary);
    }

    /* Input Styling */
    input[type="datetime-local"],
    input[type="text"] {
      width: 100%;
      padding: 0.875rem 1rem;
      border: 1px solid var(--border-color);
      background: var(--bg-primary);
      color: var(--text-primary);
      font-size: 1rem;
      transition: border-color 0.2s;
    }

    input:focus {
      outline: none;
      border-color: var(--accent-terracotta);
    }

    input::placeholder {
      color: var(--text-muted);
    }

    /* Location feedback */
    .location-feedback {
      margin-top: 0.5rem;
      font-size: 0.85rem;
      min-height: 1.5rem;
    }

    .location-feedback.success {
      color: var(--accent-sage);
    }

    .location-feedback.error {
      color: var(--accent-terracotta);
    }

    .location-feedback.loading {
      color: var(--text-muted);
    }

    /* Convert Button */
    .convert-btn {
      width: 100%;
      padding: 1rem;
      background: var(--accent-terracotta);
      color: white;
      border: none;
      font-size: 1rem;
      text-transform: uppercase;
      letter-spacing: 0.15em;
      cursor: pointer;
      transition: background 0.2s;
      margin-top: 1rem;
    }

    .convert-btn:hover {
      background: var(--accent-brown);
    }

    .convert-btn:disabled {
      background: var(--text-muted);
      cursor: not-allowed;
    }

    /* Result Display */
    .result {
      margin-top: 2rem;
      padding-top: 2rem;
      border-top: 1px solid var(--border-color);
      display: none;
      position: relative;
    }

    /* Subtle centered diamond at result divider */
    .result::before {
      content: '';
      position: absolute;
      top: -4px;
      left: 50%;
      transform: translateX(-50%) rotate(45deg);
      width: 6px;
      height: 6px;
      background: var(--bg-card);
      border-top: 1px solid var(--border-color);
      border-left: 1px solid var(--border-color);
    }

    .result.visible {
      display: block;
      animation: fadeIn 0.3s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .result-row {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      padding: 1rem 0;
      border-bottom: 1px solid var(--border-color);
    }

    .result-row:last-child {
      border-bottom: none;
    }

    .result-label {
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      color: var(--text-muted);
    }

    .result-value {
      font-size: 1.1rem;
      color: var(--text-primary);
      text-align: right;
    }

    .result-value.highlight {
      color: var(--accent-terracotta);
      font-size: 1.25rem;
    }

    /* Sun Times Section */
    .sun-times {
      margin-top: 1.5rem;
      padding-top: 0.5rem;
    }

    .sun-times-header {
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      color: var(--accent-gold);
      margin-bottom: 1rem;
      text-align: center;
    }

    .sun-times-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 1rem;
    }

    .sun-item {
      text-align: center;
      padding: 0.75rem;
      background: var(--bg-secondary);
      border-radius: 4px;
    }

    .sun-label {
      font-size: 0.65rem;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      color: var(--text-muted);
      margin-bottom: 0.25rem;
    }

    .sun-value {
      font-size: 1rem;
      font-family: 'SF Mono', 'Consolas', monospace;
      color: var(--accent-gold);
    }

    .dst-indicator {
      display: inline-block;
      padding: 0.2rem 0.5rem;
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-left: 0.5rem;
      border-radius: 2px;
    }

    .dst-indicator.active {
      background: var(--accent-gold);
      color: var(--bg-primary);
    }

    .dst-indicator.inactive {
      background: var(--accent-sage);
      color: white;
    }

    /* Footer */
    footer {
      text-align: center;
      margin-top: 2rem;
      padding-top: 1.5rem;
      position: relative;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 1rem;
    }

    footer::before {
      content: '';
      position: absolute;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 80px;
      height: 1px;
      background: linear-gradient(90deg,
        transparent 0%,
        var(--border-color) 30%,
        var(--border-color) 70%,
        transparent 100%
      );
    }


    .footer-buttons {
      display: flex;
      gap: 1rem;
      justify-content: center;
    }

    .bmc-button {
      background: transparent;
      border: 1px solid var(--border-color);
      padding: 0.5rem 1.25rem;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      color: var(--text-muted);
      text-decoration: none;
      transition: all 0.2s;
      position: relative;
    }

    .bmc-button::before,
    .bmc-button::after {
      content: '';
      position: absolute;
      width: 8px;
      height: 8px;
      border: 1px solid var(--accent-gold);
      opacity: 0.6;
    }

    .bmc-button::before {
      top: -1px;
      left: -1px;
      border-right: none;
      border-bottom: none;
    }

    .bmc-button::after {
      bottom: -1px;
      right: -1px;
      border-left: none;
      border-top: none;
    }

    .bmc-button:hover {
      border-color: var(--accent-gold);
      color: var(--text-secondary);
    }

    /* Responsive - iPhone optimized, fills viewport */
    @media (max-width: 600px) {
      .container {
        padding: 1rem;
      }

      header {
        margin-bottom: 0.75rem;
      }

      header::after {
        margin: 0.5rem auto 0;
        width: 120px;
      }

      h1 {
        font-size: 1.3rem;
      }

      .subtitle {
        display: none;
      }

      .clocks-strip {
        flex-direction: row;
        gap: 2rem;
        padding: 1rem;
        margin-bottom: 1rem;
      }

      .clock-item {
        padding: 0.5rem 0;
      }

      .clock-label {
        font-size: 0.65rem;
        margin-bottom: 0.25rem;
      }

      .clock-time {
        font-size: 1.4rem;
      }

      .card {
        padding: 1.25rem 1.75rem;
      }

      /* Simple corner brackets for mobile */
      .card::before {
        top: 8px;
        left: 8px;
        width: 20px;
        height: 20px;
        border-width: 1px;
      }

      .card::after {
        bottom: 8px;
        right: 8px;
        width: 20px;
        height: 20px;
        border-width: 1px;
      }

      .card-corner-tl,
      .card-corner-br {
        display: none;
      }

      .direction-toggle {
        margin-bottom: 1rem;
      }

      .direction-btn {
        padding: 0.75rem;
        font-size: 0.75rem;
      }

      .step {
        margin-bottom: 0.75rem;
      }

      .step-header {
        margin-bottom: 0.5rem;
        gap: 0.5rem;
      }

      .step-number {
        width: 24px;
        height: 24px;
        font-size: 0.75rem;
      }

      .step-label {
        font-size: 0.7rem;
      }

      input[type="text"] {
        padding: 0.75rem;
        font-size: 0.95rem;
        text-align: center;
        width: 100%;
        box-sizing: border-box;
      }

      input[type="datetime-local"] {
        padding: 0.75rem;
        font-size: 0.95rem;
        text-align: center;
        width: 100%;
        max-width: 100%;
        box-sizing: border-box;
        -webkit-appearance: none;
        appearance: none;
      }

      .step {
        overflow: hidden;
      }

      .location-feedback {
        min-height: 1.2rem;
        font-size: 0.75rem;
        margin-top: 0.3rem;
        text-align: center;
      }

      .convert-btn {
        margin-top: 0.5rem;
        padding: 0.875rem;
        font-size: 0.95rem;
      }

      .result {
        margin-top: 1rem;
        padding-top: 1rem;
      }

      .result-row {
        padding: 0.6rem 0;
      }

      .result-label {
        font-size: 0.65rem;
      }

      .result-value {
        font-size: 0.9rem;
      }

      .result-value.highlight {
        font-size: 1rem;
      }

      footer {
        margin-top: 0.75rem;
        padding-top: 0.75rem;
        gap: 0.5rem;
        flex-shrink: 0;
      }

      .detected-tz {
        font-size: 0.7rem;
      }

      .theme-toggle {
        padding: 0.4rem 0.75rem;
        font-size: 0.65rem;
      }
    }
  </style>
</head>
<body>
  <div class="header-band"></div>

  <div class="container">
    <header>
      <h1>UTC Hack</h1>
    </header>

    <div class="clocks-strip">
      <div class="clock-item">
        <div class="clock-label" id="utc-label">UTC</div>
        <div class="clock-time" id="utc-clock">--:--:--</div>
      </div>
      <div class="clock-item local">
        <div class="clock-label" id="local-label">Local</div>
        <div class="clock-time" id="local-clock">--:--:--</div>
      </div>
    </div>

    <div class="card">
      <div class="card-corner-tl"></div>
      <div class="card-corner-br"></div>
      <h2 class="card-title">Time Converter</h2>
      <div class="direction-toggle">
        <button class="direction-btn active" data-direction="toLocal" onclick="setDirection('toLocal')">
          UTC → Local Time
        </button>
        <button class="direction-btn" data-direction="toUTC" onclick="setDirection('toUTC')">
          Local Time → UTC
        </button>
      </div>

      <div class="step">
        <div class="step-header">
          <span class="step-number">1</span>
          <span class="step-label" id="time-step-label">Enter UTC Date & Time</span>
        </div>
        <input type="datetime-local" id="time-input">
      </div>

      <div class="step">
        <div class="step-header">
          <span class="step-number">2</span>
          <span class="step-label" id="location-step-label">Enter Location (any city or town)</span>
        </div>
        <input type="text" id="location-input" placeholder="e.g., Lincoln, Montana or Missoula, MT">
        <div class="location-feedback" id="location-feedback"></div>
      </div>

      <button class="convert-btn" id="convert-btn" onclick="convert()">Convert</button>

      <div class="result" id="result">
        <div class="result-row">
          <div class="result-label" id="result-location-label">Location</div>
          <div class="result-value" id="result-location">—</div>
        </div>
        <div class="result-row">
          <div class="result-label" id="result-timezone-label">Timezone</div>
          <div class="result-value" id="result-timezone">—</div>
        </div>
        <div class="result-row">
          <div class="result-label" id="result-utc-label">UTC Time</div>
          <div class="result-value" id="result-utc">—</div>
        </div>
        <div class="result-row">
          <div class="result-label" id="result-local-label">Local Time</div>
          <div class="result-value highlight" id="result-local">—</div>
        </div>
        <div class="sun-times" id="sun-times" style="display: none;">
          <div class="sun-times-header" id="sun-times-header">Sun Times (for selected date)</div>
          <div class="sun-times-grid">
            <div class="sun-item">
              <div class="sun-label" id="civil-dawn-label">Civil Dawn</div>
              <div class="sun-value" id="civil-dawn-time">—</div>
            </div>
            <div class="sun-item">
              <div class="sun-label" id="sunrise-label">Sunrise</div>
              <div class="sun-value" id="sunrise-time">—</div>
            </div>
            <div class="sun-item">
              <div class="sun-label" id="sunset-label">Sunset</div>
              <div class="sun-value" id="sunset-time">—</div>
            </div>
            <div class="sun-item">
              <div class="sun-label" id="civil-dusk-label">Civil Dusk</div>
              <div class="sun-value" id="civil-dusk-time">—</div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <footer>
      <div class="footer-buttons">
        <button class="theme-toggle" onclick="toggleTheme()">
          <span id="theme-icon">☀️</span>
          <span id="theme-label">Light</span>
        </button>
        <a href="https://buymeacoffee.com/gpdx" target="_blank" rel="noopener noreferrer" class="bmc-button">
          ☕ Coffee
        </a>
      </div>
    </footer>
  </div>

  <script>
    // Translations for all supported languages
    const translations = {
      en: {
        timeConverter: 'Time Converter',
        utc: 'UTC',
        local: 'Local',
        utcToLocal: 'UTC → Local Time',
        localToUtc: 'Local Time → UTC',
        enterUtcDateTime: 'Enter UTC Date & Time',
        enterLocalDateTime: 'Enter Local Date & Time',
        enterLocation: 'Enter Location (any city, town, or airport code)',
        locationPlaceholder: 'e.g., Lincoln, Montana or KJFK',
        convert: 'Convert',
        location: 'Location',
        timezone: 'Timezone',
        utcTime: 'UTC Time',
        localTime: 'Local Time',
        utcTimeInput: 'UTC Time (input)',
        localTimeResult: 'Local Time (result)',
        utcTimeResult: 'UTC Time (result)',
        localTimeInput: 'Local Time (input)',
        detectedTimezone: 'Your detected timezone:',
        light: 'Light',
        dark: 'Dark',
        lookingUp: 'Looking up...',
        locationNotFound: 'Location not found',
        lookupFailed: 'Lookup failed — try again',
        dst: 'DST',
        noDst: 'No DST',
        sunTimesHeader: 'Sun Times (for selected date)',
        civilDawn: 'Civil Dawn',
        sunrise: 'Sunrise',
        sunset: 'Sunset',
        civilDusk: 'Civil Dusk'
      },
      de: {
        timeConverter: 'Zeitumrechner',
        utc: 'UTC',
        local: 'Lokal',
        utcToLocal: 'UTC → Ortszeit',
        localToUtc: 'Ortszeit → UTC',
        enterUtcDateTime: 'UTC-Datum & Zeit eingeben',
        enterLocalDateTime: 'Lokales Datum & Zeit eingeben',
        enterLocation: 'Ort oder Flughafencode eingeben',
        locationPlaceholder: 'z.B. Berlin, München oder EDDF',
        convert: 'Umrechnen',
        location: 'Ort',
        timezone: 'Zeitzone',
        utcTime: 'UTC-Zeit',
        localTime: 'Ortszeit',
        utcTimeInput: 'UTC-Zeit (Eingabe)',
        localTimeResult: 'Ortszeit (Ergebnis)',
        utcTimeResult: 'UTC-Zeit (Ergebnis)',
        localTimeInput: 'Ortszeit (Eingabe)',
        detectedTimezone: 'Erkannte Zeitzone:',
        light: 'Hell',
        dark: 'Dunkel',
        lookingUp: 'Suche...',
        locationNotFound: 'Ort nicht gefunden',
        lookupFailed: 'Suche fehlgeschlagen',
        dst: 'Sommerzeit',
        noDst: 'Keine Sommerzeit',
        sunTimesHeader: 'Sonnenzeiten (für gewähltes Datum)',
        civilDawn: 'Bürgerliche Dämmerung',
        sunrise: 'Sonnenaufgang',
        sunset: 'Sonnenuntergang',
        civilDusk: 'Bürgerliche Abenddämmerung'
      },
      fr: {
        timeConverter: 'Convertisseur horaire',
        utc: 'UTC',
        local: 'Local',
        utcToLocal: 'UTC → Heure locale',
        localToUtc: 'Heure locale → UTC',
        enterUtcDateTime: 'Entrer date et heure UTC',
        enterLocalDateTime: 'Entrer date et heure locale',
        enterLocation: 'Entrer un lieu ou code aéroport',
        locationPlaceholder: 'ex: Paris, Lyon ou LFPG',
        convert: 'Convertir',
        location: 'Lieu',
        timezone: 'Fuseau horaire',
        utcTime: 'Heure UTC',
        localTime: 'Heure locale',
        utcTimeInput: 'Heure UTC (entrée)',
        localTimeResult: 'Heure locale (résultat)',
        utcTimeResult: 'Heure UTC (résultat)',
        localTimeInput: 'Heure locale (entrée)',
        detectedTimezone: 'Fuseau horaire détecté:',
        light: 'Clair',
        dark: 'Sombre',
        lookingUp: 'Recherche...',
        locationNotFound: 'Lieu non trouvé',
        lookupFailed: 'Échec de la recherche',
        dst: 'Heure d\'été',
        noDst: 'Pas d\'heure d\'été',
        sunTimesHeader: 'Heures du soleil (pour la date sélectionnée)',
        civilDawn: 'Aube civile',
        sunrise: 'Lever du soleil',
        sunset: 'Coucher du soleil',
        civilDusk: 'Crépuscule civil'
      },
      es: {
        timeConverter: 'Convertidor horario',
        utc: 'UTC',
        local: 'Local',
        utcToLocal: 'UTC → Hora local',
        localToUtc: 'Hora local → UTC',
        enterUtcDateTime: 'Ingrese fecha y hora UTC',
        enterLocalDateTime: 'Ingrese fecha y hora local',
        enterLocation: 'Ingrese ubicación o código de aeropuerto',
        locationPlaceholder: 'ej: Madrid, México DF o LEMD',
        convert: 'Convertir',
        location: 'Ubicación',
        timezone: 'Zona horaria',
        utcTime: 'Hora UTC',
        localTime: 'Hora local',
        utcTimeInput: 'Hora UTC (entrada)',
        localTimeResult: 'Hora local (resultado)',
        utcTimeResult: 'Hora UTC (resultado)',
        localTimeInput: 'Hora local (entrada)',
        detectedTimezone: 'Zona horaria detectada:',
        light: 'Claro',
        dark: 'Oscuro',
        lookingUp: 'Buscando...',
        locationNotFound: 'Ubicación no encontrada',
        lookupFailed: 'Error en la búsqueda',
        dst: 'Horario de verano',
        noDst: 'Sin horario de verano',
        sunTimesHeader: 'Horas del sol (para fecha seleccionada)',
        civilDawn: 'Amanecer civil',
        sunrise: 'Salida del sol',
        sunset: 'Puesta del sol',
        civilDusk: 'Crepúsculo civil'
      },
      pt: {
        timeConverter: 'Conversor de horário',
        utc: 'UTC',
        local: 'Local',
        utcToLocal: 'UTC → Hora local',
        localToUtc: 'Hora local → UTC',
        enterUtcDateTime: 'Digite data e hora UTC',
        enterLocalDateTime: 'Digite data e hora local',
        enterLocation: 'Digite localização ou código do aeroporto',
        locationPlaceholder: 'ex: São Paulo, Rio de Janeiro ou SBGR',
        convert: 'Converter',
        location: 'Localização',
        timezone: 'Fuso horário',
        utcTime: 'Hora UTC',
        localTime: 'Hora local',
        utcTimeInput: 'Hora UTC (entrada)',
        localTimeResult: 'Hora local (resultado)',
        utcTimeResult: 'Hora UTC (resultado)',
        localTimeInput: 'Hora local (entrada)',
        detectedTimezone: 'Fuso horário detectado:',
        light: 'Claro',
        dark: 'Escuro',
        lookingUp: 'Procurando...',
        locationNotFound: 'Local não encontrado',
        lookupFailed: 'Falha na busca',
        dst: 'Horário de verão',
        noDst: 'Sem horário de verão',
        sunTimesHeader: 'Horários do sol (para data selecionada)',
        civilDawn: 'Aurora civil',
        sunrise: 'Nascer do sol',
        sunset: 'Pôr do sol',
        civilDusk: 'Crepúsculo civil'
      },
      it: {
        timeConverter: 'Convertitore orario',
        utc: 'UTC',
        local: 'Locale',
        utcToLocal: 'UTC → Ora locale',
        localToUtc: 'Ora locale → UTC',
        enterUtcDateTime: 'Inserisci data e ora UTC',
        enterLocalDateTime: 'Inserisci data e ora locale',
        enterLocation: 'Inserisci località o codice aeroporto',
        locationPlaceholder: 'es: Roma, Milano o LIRF',
        convert: 'Converti',
        location: 'Località',
        timezone: 'Fuso orario',
        utcTime: 'Ora UTC',
        localTime: 'Ora locale',
        utcTimeInput: 'Ora UTC (input)',
        localTimeResult: 'Ora locale (risultato)',
        utcTimeResult: 'Ora UTC (risultato)',
        localTimeInput: 'Ora locale (input)',
        detectedTimezone: 'Fuso orario rilevato:',
        light: 'Chiaro',
        dark: 'Scuro',
        lookingUp: 'Ricerca...',
        locationNotFound: 'Località non trovata',
        lookupFailed: 'Ricerca fallita',
        dst: 'Ora legale',
        noDst: 'Nessuna ora legale',
        sunTimesHeader: 'Orari del sole (per data selezionata)',
        civilDawn: 'Alba civile',
        sunrise: 'Alba',
        sunset: 'Tramonto',
        civilDusk: 'Crepuscolo civile'
      },
      pl: {
        timeConverter: 'Konwerter czasu',
        utc: 'UTC',
        local: 'Lokalny',
        utcToLocal: 'UTC → Czas lokalny',
        localToUtc: 'Czas lokalny → UTC',
        enterUtcDateTime: 'Wprowadź datę i czas UTC',
        enterLocalDateTime: 'Wprowadź lokalną datę i czas',
        enterLocation: 'Wprowadź lokalizację lub kod lotniska',
        locationPlaceholder: 'np. Warszawa, Kraków lub EPWA',
        convert: 'Konwertuj',
        location: 'Lokalizacja',
        timezone: 'Strefa czasowa',
        utcTime: 'Czas UTC',
        localTime: 'Czas lokalny',
        utcTimeInput: 'Czas UTC (wejście)',
        localTimeResult: 'Czas lokalny (wynik)',
        utcTimeResult: 'Czas UTC (wynik)',
        localTimeInput: 'Czas lokalny (wejście)',
        detectedTimezone: 'Wykryta strefa czasowa:',
        light: 'Jasny',
        dark: 'Ciemny',
        lookingUp: 'Szukam...',
        locationNotFound: 'Nie znaleziono lokalizacji',
        lookupFailed: 'Wyszukiwanie nie powiodło się',
        dst: 'Czas letni',
        noDst: 'Bez czasu letniego',
        sunTimesHeader: 'Godziny słoneczne (dla wybranej daty)',
        civilDawn: 'Świt cywilny',
        sunrise: 'Wschód słońca',
        sunset: 'Zachód słońca',
        civilDusk: 'Zmierzch cywilny'
      },
      nl: {
        timeConverter: 'Tijdconverter',
        utc: 'UTC',
        local: 'Lokaal',
        utcToLocal: 'UTC → Lokale tijd',
        localToUtc: 'Lokale tijd → UTC',
        enterUtcDateTime: 'Voer UTC-datum en tijd in',
        enterLocalDateTime: 'Voer lokale datum en tijd in',
        enterLocation: 'Voer locatie of luchthavencode in',
        locationPlaceholder: 'bijv. Amsterdam, Rotterdam of EHAM',
        convert: 'Converteren',
        location: 'Locatie',
        timezone: 'Tijdzone',
        utcTime: 'UTC-tijd',
        localTime: 'Lokale tijd',
        utcTimeInput: 'UTC-tijd (invoer)',
        localTimeResult: 'Lokale tijd (resultaat)',
        utcTimeResult: 'UTC-tijd (resultaat)',
        localTimeInput: 'Lokale tijd (invoer)',
        detectedTimezone: 'Gedetecteerde tijdzone:',
        light: 'Licht',
        dark: 'Donker',
        lookingUp: 'Zoeken...',
        locationNotFound: 'Locatie niet gevonden',
        lookupFailed: 'Zoeken mislukt',
        dst: 'Zomertijd',
        noDst: 'Geen zomertijd',
        sunTimesHeader: 'Zonnetijden (voor geselecteerde datum)',
        civilDawn: 'Burgerlijke dageraad',
        sunrise: 'Zonsopgang',
        sunset: 'Zonsondergang',
        civilDusk: 'Burgerlijke schemering'
      },
      ru: {
        timeConverter: 'Конвертер времени',
        utc: 'UTC',
        local: 'Местное',
        utcToLocal: 'UTC → Местное время',
        localToUtc: 'Местное время → UTC',
        enterUtcDateTime: 'Введите дату и время UTC',
        enterLocalDateTime: 'Введите местную дату и время',
        enterLocation: 'Введите местоположение или код аэропорта',
        locationPlaceholder: 'напр. Москва, Санкт-Петербург или UUEE',
        convert: 'Конвертировать',
        location: 'Местоположение',
        timezone: 'Часовой пояс',
        utcTime: 'Время UTC',
        localTime: 'Местное время',
        utcTimeInput: 'Время UTC (ввод)',
        localTimeResult: 'Местное время (результат)',
        utcTimeResult: 'Время UTC (результат)',
        localTimeInput: 'Местное время (ввод)',
        detectedTimezone: 'Определённый часовой пояс:',
        light: 'Светлая',
        dark: 'Тёмная',
        lookingUp: 'Поиск...',
        locationNotFound: 'Местоположение не найдено',
        lookupFailed: 'Ошибка поиска',
        dst: 'Летнее время',
        noDst: 'Без летнего времени',
        sunTimesHeader: 'Время солнца (для выбранной даты)',
        civilDawn: 'Гражданский рассвет',
        sunrise: 'Восход',
        sunset: 'Закат',
        civilDusk: 'Гражданские сумерки'
      },
      ja: {
        timeConverter: '時間変換',
        utc: 'UTC',
        local: '現地',
        utcToLocal: 'UTC → 現地時間',
        localToUtc: '現地時間 → UTC',
        enterUtcDateTime: 'UTC日時を入力',
        enterLocalDateTime: '現地日時を入力',
        enterLocation: '場所または空港コードを入力',
        locationPlaceholder: '例：東京、大阪、RJTT',
        convert: '変換',
        location: '場所',
        timezone: 'タイムゾーン',
        utcTime: 'UTC時間',
        localTime: '現地時間',
        utcTimeInput: 'UTC時間（入力）',
        localTimeResult: '現地時間（結果）',
        utcTimeResult: 'UTC時間（結果）',
        localTimeInput: '現地時間（入力）',
        detectedTimezone: '検出されたタイムゾーン：',
        light: 'ライト',
        dark: 'ダーク',
        lookingUp: '検索中...',
        locationNotFound: '場所が見つかりません',
        lookupFailed: '検索に失敗しました',
        dst: '夏時間',
        noDst: '夏時間なし',
        sunTimesHeader: '太陽時刻（選択した日付）',
        civilDawn: '市民薄明',
        sunrise: '日の出',
        sunset: '日の入り',
        civilDusk: '市民薄暮'
      },
      zh: {
        timeConverter: '时间转换器',
        utc: 'UTC',
        local: '本地',
        utcToLocal: 'UTC → 本地时间',
        localToUtc: '本地时间 → UTC',
        enterUtcDateTime: '输入UTC日期和时间',
        enterLocalDateTime: '输入本地日期和时间',
        enterLocation: '输入位置或机场代码',
        locationPlaceholder: '例如：北京、上海、ZBAA',
        convert: '转换',
        location: '位置',
        timezone: '时区',
        utcTime: 'UTC时间',
        localTime: '本地时间',
        utcTimeInput: 'UTC时间（输入）',
        localTimeResult: '本地时间（结果）',
        utcTimeResult: 'UTC时间（结果）',
        localTimeInput: '本地时间（输入）',
        detectedTimezone: '检测到的时区：',
        light: '浅色',
        dark: '深色',
        lookingUp: '搜索中...',
        locationNotFound: '未找到位置',
        lookupFailed: '搜索失败',
        dst: '夏令时',
        noDst: '无夏令时',
        sunTimesHeader: '太阳时间（所选日期）',
        civilDawn: '民用曙光',
        sunrise: '日出',
        sunset: '日落',
        civilDusk: '民用暮光'
      },
      ko: {
        timeConverter: '시간 변환기',
        utc: 'UTC',
        local: '현지',
        utcToLocal: 'UTC → 현지 시간',
        localToUtc: '현지 시간 → UTC',
        enterUtcDateTime: 'UTC 날짜 및 시간 입력',
        enterLocalDateTime: '현지 날짜 및 시간 입력',
        enterLocation: '위치 또는 공항 코드 입력',
        locationPlaceholder: '예: 서울, 부산, RKSI',
        convert: '변환',
        location: '위치',
        timezone: '시간대',
        utcTime: 'UTC 시간',
        localTime: '현지 시간',
        utcTimeInput: 'UTC 시간 (입력)',
        localTimeResult: '현지 시간 (결과)',
        utcTimeResult: 'UTC 시간 (결과)',
        localTimeInput: '현지 시간 (입력)',
        detectedTimezone: '감지된 시간대:',
        light: '라이트',
        dark: '다크',
        lookingUp: '검색 중...',
        locationNotFound: '위치를 찾을 수 없음',
        lookupFailed: '검색 실패',
        dst: '일광 절약 시간',
        noDst: '일광 절약 시간 없음',
        sunTimesHeader: '태양 시간 (선택한 날짜)',
        civilDawn: '시민 박명',
        sunrise: '일출',
        sunset: '일몰',
        civilDusk: '시민 황혼'
      },
      ar: {
        timeConverter: 'محول الوقت',
        utc: 'UTC',
        local: 'محلي',
        utcToLocal: 'UTC ← الوقت المحلي',
        localToUtc: 'الوقت المحلي ← UTC',
        enterUtcDateTime: 'أدخل تاريخ ووقت UTC',
        enterLocalDateTime: 'أدخل التاريخ والوقت المحلي',
        enterLocation: 'أدخل الموقع أو رمز المطار',
        locationPlaceholder: 'مثال: دبي، الرياض، OMDB',
        convert: 'تحويل',
        location: 'الموقع',
        timezone: 'المنطقة الزمنية',
        utcTime: 'وقت UTC',
        localTime: 'الوقت المحلي',
        utcTimeInput: 'وقت UTC (إدخال)',
        localTimeResult: 'الوقت المحلي (النتيجة)',
        utcTimeResult: 'وقت UTC (النتيجة)',
        localTimeInput: 'الوقت المحلي (إدخال)',
        detectedTimezone: 'المنطقة الزمنية المكتشفة:',
        light: 'فاتح',
        dark: 'داكن',
        lookingUp: 'جاري البحث...',
        locationNotFound: 'الموقع غير موجود',
        lookupFailed: 'فشل البحث',
        dst: 'التوقيت الصيفي',
        noDst: 'بدون توقيت صيفي',
        sunTimesHeader: 'أوقات الشمس (للتاريخ المحدد)',
        civilDawn: 'الفجر المدني',
        sunrise: 'شروق الشمس',
        sunset: 'غروب الشمس',
        civilDusk: 'الغسق المدني'
      }
    };

    // Detect language from URL path
    const supportedLangs = ['en', 'de', 'fr', 'es', 'pt', 'it', 'pl', 'nl', 'ru', 'ja', 'zh', 'ko', 'ar'];
    const pathLang = window.location.pathname.split('/')[1];
    const currentLang = supportedLangs.includes(pathLang) ? pathLang : 'en';
    const t = translations[currentLang];

    // State
    let currentDirection = 'toLocal';
    let resolvedTimezone = null;
    let resolvedDisplayName = null;
    let resolvedSunTimes = null;
    const userTimezone = Intl.DateTimeFormat().resolvedOptions().timeZone;

    // Apply translations to the page
    function applyTranslations() {
      try {
        // Clock labels
        document.getElementById('utc-label').textContent = t.utc;
        document.getElementById('local-label').textContent = t.local;

        // Card title
        document.querySelector('.card-title').textContent = t.timeConverter;

        // Direction buttons
        document.querySelector('[data-direction="toLocal"]').textContent = t.utcToLocal;
        document.querySelector('[data-direction="toUTC"]').textContent = t.localToUtc;

        // Step labels
        document.getElementById('time-step-label').textContent = t.enterUtcDateTime;
        document.getElementById('location-step-label').textContent = t.enterLocation;

        // Input placeholder
        document.getElementById('location-input').placeholder = t.locationPlaceholder;

        // Convert button
        document.getElementById('convert-btn').textContent = t.convert;

        // Result labels
        document.getElementById('result-location-label').textContent = t.location;
        document.getElementById('result-timezone-label').textContent = t.timezone;
        document.getElementById('result-utc-label').textContent = t.utcTime;
        document.getElementById('result-local-label').textContent = t.localTime;

        // Footer
        document.getElementById('theme-label').textContent = t.light;

        // Sun times labels
        document.getElementById('sun-times-header').textContent = t.sunTimesHeader;
        document.getElementById('civil-dawn-label').textContent = t.civilDawn;
        document.getElementById('sunrise-label').textContent = t.sunrise;
        document.getElementById('sunset-label').textContent = t.sunset;
        document.getElementById('civil-dusk-label').textContent = t.civilDusk;

        // Set HTML lang attribute
        document.documentElement.lang = currentLang;

        // Set text direction for Arabic
        if (currentLang === 'ar') {
          document.documentElement.dir = 'rtl';
        }
      } catch (e) {
        console.error('Translation error:', e);
      }
    }

    // Initialize
    document.addEventListener('DOMContentLoaded', () => {
      applyTranslations();
      updateClocks();
      setInterval(updateClocks, 1000);
      setDefaultTime();

      // Load saved theme
      const savedTheme = localStorage.getItem('theme') || 'light';
      setTheme(savedTheme);

      // Location input with debounce
      document.getElementById('location-input').addEventListener('input', debounce(lookupLocation, 400));
    });

    function updateClocks() {
      const now = new Date();
      document.getElementById('utc-clock').textContent = now.toLocaleTimeString('en-US', {
        timeZone: 'UTC', hour12: false, hour: '2-digit', minute: '2-digit', second: '2-digit'
      });
      document.getElementById('local-clock').textContent = now.toLocaleTimeString('en-US', {
        hour12: false, hour: '2-digit', minute: '2-digit', second: '2-digit'
      });
    }

    function setDefaultTime() {
      const now = new Date();
      document.getElementById('time-input').value = now.toISOString().slice(0, 16);
    }

    function setDirection(dir) {
      currentDirection = dir;
      document.querySelectorAll('.direction-btn').forEach(btn => {
        btn.classList.toggle('active', btn.dataset.direction === dir);
      });

      // Update labels
      const timeLabel = document.getElementById('time-step-label');
      const resultUtcLabel = document.getElementById('result-utc-label');
      const resultLocalLabel = document.getElementById('result-local-label');

      if (dir === 'toLocal') {
        timeLabel.textContent = t.enterUtcDateTime;
        resultUtcLabel.textContent = t.utcTimeInput;
        resultLocalLabel.textContent = t.localTimeResult;
      } else {
        timeLabel.textContent = t.enterLocalDateTime;
        resultUtcLabel.textContent = t.utcTimeResult;
        resultLocalLabel.textContent = t.localTimeInput;
      }

      // Clear previous result
      document.getElementById('result').classList.remove('visible');
    }

    async function lookupLocation() {
      const input = document.getElementById('location-input').value.trim();
      const feedback = document.getElementById('location-feedback');

      if (!input) {
        feedback.textContent = '';
        feedback.className = 'location-feedback';
        resolvedTimezone = null;
        resolvedSunTimes = null;
        return;
      }

      feedback.textContent = t.lookingUp;
      feedback.className = 'location-feedback loading';

      try {
        const res = await fetch(`/api/location?q=${encodeURIComponent(input)}`);
        const data = await res.json();

        if (data.timezone) {
          resolvedTimezone = data.timezone;
          resolvedDisplayName = data.displayName;
          resolvedSunTimes = data.sunTimes || null;
          feedback.textContent = `✓ ${data.timezone} (${data.tzAbbreviation})`;
          feedback.className = 'location-feedback success';
        } else {
          resolvedTimezone = null;
          resolvedSunTimes = null;
          feedback.textContent = t.locationNotFound;
          feedback.className = 'location-feedback error';
        }
      } catch (e) {
        resolvedTimezone = null;
        feedback.textContent = t.lookupFailed;
        feedback.className = 'location-feedback error';
      }
    }

    async function convert() {
      const timeInput = document.getElementById('time-input').value;

      if (!timeInput) {
        alert('Please enter a date and time');
        return;
      }

      if (!resolvedTimezone) {
        alert('Please enter a valid location');
        return;
      }

      try {
        const res = await fetch('/api/convert', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            time: timeInput,
            timezone: resolvedTimezone,
            direction: currentDirection
          })
        });

        const data = await res.json();

        if (data.error) {
          alert(data.error);
          return;
        }

        // Populate results
        document.getElementById('result-location').textContent = shortenDisplayName(resolvedDisplayName);

        let tzDisplay = `${data.timezone} (${data.tzAbbreviation})`;
        if (data.isDST) {
          tzDisplay += '<span class="dst-indicator active">DST</span>';
        } else if (resolvedTimezone === 'America/Phoenix') {
          tzDisplay += '<span class="dst-indicator inactive">No DST</span>';
        }
        document.getElementById('result-timezone').innerHTML = tzDisplay;

        document.getElementById('result-utc').textContent = data.utcFormatted;
        document.getElementById('result-local').textContent = data.localFormatted;

        // Highlight the result based on direction
        const utcEl = document.getElementById('result-utc');
        const localEl = document.getElementById('result-local');

        if (currentDirection === 'toLocal') {
          utcEl.classList.remove('highlight');
          localEl.classList.add('highlight');
        } else {
          localEl.classList.remove('highlight');
          utcEl.classList.add('highlight');
        }

        // Display sun times if available
        displaySunTimes();

        document.getElementById('result').classList.add('visible');
      } catch (e) {
        alert('Conversion failed');
      }
    }

    function displaySunTimes() {
      const sunTimesEl = document.getElementById('sun-times');

      if (!resolvedSunTimes) {
        sunTimesEl.style.display = 'none';
        return;
      }

      // API returns {utc, zulu, local} objects - use local time
      const getLocalTime = (timeObj) => {
        if (!timeObj || !timeObj.local) return '—';
        return timeObj.local;
      };

      document.getElementById('civil-dawn-time').textContent = getLocalTime(resolvedSunTimes.civilDawn);
      document.getElementById('sunrise-time').textContent = getLocalTime(resolvedSunTimes.sunrise);
      document.getElementById('sunset-time').textContent = getLocalTime(resolvedSunTimes.sunset);
      document.getElementById('civil-dusk-time').textContent = getLocalTime(resolvedSunTimes.civilDusk);

      sunTimesEl.style.display = 'block';
    }

    function shortenDisplayName(name) {
      if (!name) return '—';
      // Take first two parts (city, state/country)
      const parts = name.split(', ');
      return parts.slice(0, 2).join(', ');
    }

    function toggleTheme() {
      const html = document.documentElement;
      const current = html.getAttribute('data-theme');
      const next = current === 'light' ? 'dark' : 'light';
      setTheme(next);
      localStorage.setItem('theme', next);
    }

    function setTheme(theme) {
      document.documentElement.setAttribute('data-theme', theme);
      document.getElementById('theme-icon').textContent = theme === 'light' ? '☀️' : '🌙';
      document.getElementById('theme-label').textContent = theme === 'light' ? t.light : t.dark;
    }

    function debounce(func, wait) {
      let timeout;
      return function(...args) {
        clearTimeout(timeout);
        timeout = setTimeout(() => func.apply(this, args), wait);
      };
    }

    // Register service worker for PWA
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('/sw.js').catch(() => {});
    }

    // Pull to refresh
    let touchStartY = 0;
    let isPulling = false;
    let isRefreshing = false;

    function getScrollTop() {
      return window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0;
    }

    document.addEventListener('touchstart', (e) => {
      if (getScrollTop() <= 0 && !isRefreshing) {
        touchStartY = e.touches[0].clientY;
        isPulling = true;
      }
    }, { passive: true });

    document.addEventListener('touchmove', (e) => {
      if (!isPulling || isRefreshing) return;
      const touchY = e.touches[0].clientY;
      const pullDistance = touchY - touchStartY;
      if (pullDistance > 100 && getScrollTop() <= 0) {
        isPulling = false;
        isRefreshing = true;
        document.body.style.transition = 'opacity 0.2s ease';
        document.body.style.opacity = '0.5';
        setTimeout(() => location.reload(), 200);
      }
    }, { passive: true });

    document.addEventListener('touchend', () => {
      isPulling = false;
    });
  </script>
</body>
</html>
