<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>UTC Hack ‚Äî Zulu Time Converter for Pilots & Aviation</title>

  <!-- SEO Meta Tags -->
  <meta name="description" content="Free UTC/Zulu time converter for pilots and aviation professionals. Convert between Zulu time and local time for any city. Perfect for flight planning, METAR/TAF interpretation, and international operations.">
  <meta name="keywords" content="UTC, Zulu time, pilot, aviation, flight planning, timezone converter, GMT, METAR, TAF, world clock, DST, ATC, international flights">
  <link rel="canonical" href="https://utchack.com/">

  <!-- Hreflang tags for international SEO -->
  <link rel="alternate" hreflang="en" href="https://utchack.com/">
  <link rel="alternate" hreflang="de" href="https://utchack.com/de/">
  <link rel="alternate" hreflang="fr" href="https://utchack.com/fr/">
  <link rel="alternate" hreflang="es" href="https://utchack.com/es/">
  <link rel="alternate" hreflang="pt" href="https://utchack.com/pt/">
  <link rel="alternate" hreflang="it" href="https://utchack.com/it/">
  <link rel="alternate" hreflang="pl" href="https://utchack.com/pl/">
  <link rel="alternate" hreflang="nl" href="https://utchack.com/nl/">
  <link rel="alternate" hreflang="ru" href="https://utchack.com/ru/">
  <link rel="alternate" hreflang="ja" href="https://utchack.com/ja/">
  <link rel="alternate" hreflang="zh" href="https://utchack.com/zh/">
  <link rel="alternate" hreflang="ko" href="https://utchack.com/ko/">
  <link rel="alternate" hreflang="ar" href="https://utchack.com/ar/">
  <link rel="alternate" hreflang="x-default" href="https://utchack.com/">

  <!-- Open Graph / Social Sharing -->
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://utchack.com/">
  <meta property="og:title" content="UTC Hack ‚Äî Zulu Time Converter for Pilots">
  <meta property="og:description" content="Free UTC/Zulu time converter for pilots and aviation. Convert between Zulu and local time for any city worldwide.">
  <meta property="og:image" content="https://utchack.com/icon-512.png">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="UTC Hack ‚Äî Zulu Time Converter for Pilots">
  <meta name="twitter:description" content="Free UTC/Zulu time converter for pilots and aviation.">

  <!-- Structured Data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "UTC Hack - Zulu Time Converter",
    "url": "https://utchack.com",
    "description": "Free UTC/Zulu time converter for pilots and aviation professionals. Convert between Zulu time and local time for flight planning, METAR interpretation, and international operations.",
    "applicationCategory": "UtilityApplication",
    "keywords": "Zulu time, UTC, pilot, aviation, flight planning, timezone",
    "audience": {
      "@type": "Audience",
      "audienceType": "Pilots, Aviation Professionals, Flight Dispatchers"
    },
    "operatingSystem": "Any",
    "offers": {
      "@type": "Offer",
      "price": "0",
      "priceCurrency": "USD"
    }
  }
  </script>

  <!-- PWA Meta Tags -->
  <meta name="application-name" content="UTC Hack">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="UTC Hack">
  <meta name="theme-color" content="#c45c3e">

  <!-- Icons -->
  <link rel="icon" type="image/svg+xml" href="/icon.svg">
  <link rel="apple-touch-icon" href="/icon-180.png">
  <link rel="manifest" href="/manifest.json">
  <style>
    :root {
      /* Frank Lloyd Wright Prairie Style - Light Theme */
      --bg-primary: #f5f0e6;
      --bg-secondary: #ebe4d4;
      --bg-card: #fff8ee;
      --text-primary: #2c2416;
      --text-secondary: #5c4d3a;
      --text-muted: #8b7d6b;
      --accent-terracotta: #c45c3e;
      --accent-gold: #c9a227;
      --accent-sage: #7a8b6e;
      --accent-brown: #6b4423;
      --border-color: #d4c9b5;
      --border-strong: #b8a88a;
      --shadow: rgba(44, 36, 22, 0.1);
      --geometric-line: #c45c3e;
      --leadwork: rgba(107, 68, 35, 0.35);
    }

    [data-theme="dark"] {
      --bg-primary: #1a1612;
      --bg-secondary: #2a241c;
      --bg-card: #322a20;
      --text-primary: #f0e8d8;
      --text-secondary: #c9bda8;
      --text-muted: #8b7d6b;
      --accent-terracotta: #e07050;
      --accent-gold: #ddb84a;
      --accent-sage: #9aab8e;
      --accent-brown: #a67c52;
      --border-color: #4a4035;
      --border-strong: #6b5d4a;
      --shadow: rgba(0, 0, 0, 0.3);
      --geometric-line: #e07050;
      --leadwork: rgba(180, 160, 130, 0.5);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', 'Helvetica Neue', Arial, sans-serif;
      background-color: var(--bg-primary);
      color: var(--text-primary);
      min-height: 100vh;
      line-height: 1.6;
      transition: background-color 0.3s, color 0.3s;
    }

    /* FLW Geometric Header Band - subtle */
    .header-band {
      background: var(--accent-brown);
      height: 3px;
      position: relative;
    }

    .header-band::after {
      content: '';
      position: absolute;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 60px;
      height: 3px;
      background: var(--accent-gold);
    }

    .container {
      max-width: 720px;
      margin: 0 auto;
      padding: 2rem 1.5rem;
      position: relative;
    }

    /* Subtle FLW-inspired vertical leadwork borders */
    .container::before,
    .container::after {
      content: '';
      position: fixed;
      top: 0;
      bottom: 0;
      width: 20px;
      pointer-events: none;
      opacity: 0.7;
      background:
        /* Thin vertical lines */
        linear-gradient(90deg,
          transparent 0px,
          transparent 8px,
          var(--leadwork) 8px,
          var(--leadwork) 9px,
          transparent 9px,
          transparent 11px,
          var(--leadwork) 11px,
          var(--leadwork) 12px,
          transparent 12px
        ),
        /* Small diamond accents */
        repeating-linear-gradient(180deg,
          transparent 0px,
          transparent 80px,
          var(--leadwork) 80px,
          transparent 84px,
          transparent 88px
        );
    }

    .container::before {
      left: 0;
    }

    .container::after {
      right: 0;
      transform: scaleX(-1);
    }

    @media (max-width: 800px) {
      .container::before,
      .container::after {
        display: none;
      }
    }

    /* Header with horizontal emphasis */
    header {
      text-align: center;
      margin-bottom: 2rem;
      position: relative;
    }

    header::after {
      content: '';
      display: block;
      width: 200px;
      height: 3px;
      background: var(--accent-terracotta);
      margin: 1rem auto 0;
    }

    h1 {
      font-size: 1.8rem;
      font-weight: 400;
      letter-spacing: 0.15em;
      text-transform: uppercase;
      color: var(--text-primary);
    }

    .subtitle {
      color: var(--text-muted);
      font-size: 0.9rem;
      margin-top: 0.5rem;
      letter-spacing: 0.05em;
    }

    /* Theme Toggle - FLW style */
    .theme-toggle {
      background: transparent;
      border: 1px solid var(--border-color);
      padding: 0.5rem 1.25rem;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      color: var(--text-muted);
      transition: all 0.2s;
      position: relative;
    }

    .theme-toggle::before,
    .theme-toggle::after {
      content: '';
      position: absolute;
      width: 8px;
      height: 8px;
      border: 1px solid var(--accent-gold);
      opacity: 0.6;
    }

    .theme-toggle::before {
      top: -1px;
      left: -1px;
      border-right: none;
      border-bottom: none;
    }

    .theme-toggle::after {
      bottom: -1px;
      right: -1px;
      border-left: none;
      border-top: none;
    }

    .theme-toggle:hover {
      border-color: var(--accent-gold);
      color: var(--text-secondary);
    }

    /* Live Clocks - Horizontal Strip */
    .clocks-strip {
      display: flex;
      justify-content: center;
      gap: 3rem;
      padding: 1.5rem;
      background: var(--bg-secondary);
      border-top: 1px solid var(--border-color);
      border-bottom: 1px solid var(--border-color);
      margin-bottom: 2rem;
      position: relative;
    }

    /* Subtle horizontal line accents */
    .clocks-strip::before,
    .clocks-strip::after {
      content: '';
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
      width: 120px;
      height: 1px;
      background: linear-gradient(90deg,
        transparent 0%,
        var(--leadwork) 20%,
        var(--leadwork) 80%,
        transparent 100%
      );
    }

    .clocks-strip::before {
      top: 4px;
    }

    .clocks-strip::after {
      bottom: 4px;
    }

    .clock-item {
      text-align: center;
    }

    .clock-label {
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.15em;
      color: var(--text-muted);
      margin-bottom: 0.25rem;
    }

    .clock-time {
      font-size: 1.5rem;
      font-weight: 300;
      font-family: 'SF Mono', 'Consolas', monospace;
      color: var(--accent-terracotta);
    }

    .clock-item.local .clock-time {
      color: var(--accent-sage);
    }

    /* Main Card */
    .card {
      background: var(--bg-card);
      border: 1px solid var(--border-strong);
      padding: 2rem;
      position: relative;
    }

    /* FLW-style corner accents - like window leading */
    .card::before,
    .card::after {
      content: '';
      position: absolute;
      pointer-events: none;
    }

    .card::before {
      top: 10px;
      left: 10px;
      width: 45px;
      height: 45px;
      border-left: 2px solid var(--accent-gold);
      border-top: 2px solid var(--accent-gold);
      opacity: 0.7;
    }

    .card::after {
      bottom: 10px;
      right: 10px;
      width: 45px;
      height: 45px;
      border-right: 2px solid var(--accent-gold);
      border-bottom: 2px solid var(--accent-gold);
      opacity: 0.7;
    }

    /* Small squares at corner bracket ends */
    .card-corner-tl,
    .card-corner-br {
      position: absolute;
      width: 6px;
      height: 6px;
      background: var(--accent-gold);
      opacity: 0.7;
    }

    .card-corner-tl {
      top: 10px;
      left: 10px;
    }

    .card-corner-br {
      bottom: 10px;
      right: 10px;
    }

    .card-title {
      font-size: 1.1rem;
      font-weight: 400;
      text-transform: uppercase;
      letter-spacing: 0.15em;
      color: var(--text-secondary);
      text-align: center;
      margin-bottom: 1.5rem;
      padding-bottom: 1rem;
      border-bottom: 1px solid var(--border-color);
    }

    /* Direction Toggle */
    .direction-toggle {
      display: flex;
      margin-bottom: 2rem;
      border: 1px solid var(--border-color);
      border-radius: 0;
    }

    .direction-btn {
      flex: 1;
      padding: 1rem;
      background: var(--bg-secondary);
      border: none;
      cursor: pointer;
      font-size: 0.85rem;
      color: var(--text-secondary);
      transition: all 0.2s;
      text-transform: uppercase;
      letter-spacing: 0.1em;
    }

    .direction-btn:first-child {
      border-right: 1px solid var(--border-color);
    }

    .direction-btn.active {
      background: var(--accent-terracotta);
      color: white;
    }

    .direction-btn:hover:not(.active) {
      background: var(--bg-primary);
    }

    /* Form Steps */
    .step {
      margin-bottom: 1.5rem;
    }

    .step-header {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      margin-bottom: 0.75rem;
    }

    .step-number {
      width: 28px;
      height: 28px;
      background: var(--accent-terracotta);
      color: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.85rem;
      font-weight: 600;
    }

    .step-label {
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      color: var(--text-secondary);
    }

    /* Input Styling */
    input[type="datetime-local"],
    input[type="text"] {
      width: 100%;
      padding: 0.875rem 1rem;
      border: 1px solid var(--border-color);
      background: var(--bg-primary);
      color: var(--text-primary);
      font-size: 1rem;
      transition: border-color 0.2s;
    }

    input:focus {
      outline: none;
      border-color: var(--accent-terracotta);
    }

    input::placeholder {
      color: var(--text-muted);
    }

    /* Location feedback */
    .location-feedback {
      margin-top: 0.5rem;
      font-size: 0.85rem;
      min-height: 1.5rem;
    }

    .location-feedback.success {
      color: var(--accent-sage);
    }

    .location-feedback.error {
      color: var(--accent-terracotta);
    }

    .location-feedback.loading {
      color: var(--text-muted);
    }

    /* Convert Button */
    .convert-btn {
      width: 100%;
      padding: 1rem;
      background: var(--accent-terracotta);
      color: white;
      border: none;
      font-size: 1rem;
      text-transform: uppercase;
      letter-spacing: 0.15em;
      cursor: pointer;
      transition: background 0.2s;
      margin-top: 1rem;
    }

    .convert-btn:hover {
      background: var(--accent-brown);
    }

    .convert-btn:disabled {
      background: var(--text-muted);
      cursor: not-allowed;
    }

    /* Result Display */
    .result {
      margin-top: 2rem;
      padding-top: 2rem;
      border-top: 1px solid var(--border-color);
      display: none;
      position: relative;
    }

    /* Subtle centered diamond at result divider */
    .result::before {
      content: '';
      position: absolute;
      top: -4px;
      left: 50%;
      transform: translateX(-50%) rotate(45deg);
      width: 6px;
      height: 6px;
      background: var(--bg-card);
      border-top: 1px solid var(--border-color);
      border-left: 1px solid var(--border-color);
    }

    .result.visible {
      display: block;
      animation: fadeIn 0.3s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .result-row {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      padding: 1rem 0;
      border-bottom: 1px solid var(--border-color);
    }

    .result-row:last-child {
      border-bottom: none;
    }

    .result-label {
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      color: var(--text-muted);
    }

    .result-value {
      font-size: 1.1rem;
      color: var(--text-primary);
      text-align: right;
    }

    .result-value.highlight {
      color: var(--accent-terracotta);
      font-size: 1.25rem;
    }

    .dst-indicator {
      display: inline-block;
      padding: 0.2rem 0.5rem;
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-left: 0.5rem;
      border-radius: 2px;
    }

    .dst-indicator.active {
      background: var(--accent-gold);
      color: var(--bg-primary);
    }

    .dst-indicator.inactive {
      background: var(--accent-sage);
      color: white;
    }

    /* Footer */
    footer {
      text-align: center;
      margin-top: 2rem;
      padding-top: 1.5rem;
      position: relative;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 1rem;
    }

    footer::before {
      content: '';
      position: absolute;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 80px;
      height: 1px;
      background: linear-gradient(90deg,
        transparent 0%,
        var(--border-color) 30%,
        var(--border-color) 70%,
        transparent 100%
      );
    }

    .detected-tz {
      font-size: 0.8rem;
      color: var(--text-muted);
    }

    /* Responsive - iPhone optimized, fills viewport */
    @media (max-width: 600px) {
      .container {
        padding: 1rem;
      }

      header {
        margin-bottom: 0.75rem;
      }

      header::after {
        margin: 0.5rem auto 0;
        width: 120px;
      }

      h1 {
        font-size: 1.3rem;
      }

      .subtitle {
        display: none;
      }

      .clocks-strip {
        flex-direction: column;
        gap: 0;
        padding: 0.75rem 0;
        margin-bottom: 1rem;
        background: transparent;
        border: none;
      }

      .clocks-strip::before,
      .clocks-strip::after {
        display: none;
      }

      .clock-item {
        padding: 0.5rem 0;
      }

      .clock-label {
        font-size: 0.65rem;
        margin-bottom: 0.25rem;
      }

      .clock-time {
        font-size: 1.8rem;
      }

      .card {
        padding: 1.25rem 1.75rem;
      }

      /* Simple corner brackets for mobile */
      .card::before {
        top: 8px;
        left: 8px;
        width: 20px;
        height: 20px;
        border-width: 1px;
      }

      .card::after {
        bottom: 8px;
        right: 8px;
        width: 20px;
        height: 20px;
        border-width: 1px;
      }

      .card-corner-tl,
      .card-corner-br {
        display: none;
      }

      .direction-toggle {
        margin-bottom: 1rem;
      }

      .direction-btn {
        padding: 0.75rem;
        font-size: 0.75rem;
      }

      .step {
        margin-bottom: 0.75rem;
      }

      .step-header {
        margin-bottom: 0.5rem;
        gap: 0.5rem;
      }

      .step-number {
        width: 24px;
        height: 24px;
        font-size: 0.75rem;
      }

      .step-label {
        font-size: 0.7rem;
      }

      input[type="text"] {
        padding: 0.75rem;
        font-size: 0.95rem;
        text-align: center;
        width: 100%;
        box-sizing: border-box;
      }

      input[type="datetime-local"] {
        padding: 0.75rem;
        font-size: 0.95rem;
        text-align: center;
        width: 100%;
        max-width: 100%;
        box-sizing: border-box;
        -webkit-appearance: none;
        appearance: none;
      }

      .step {
        overflow: hidden;
      }

      .location-feedback {
        min-height: 1.2rem;
        font-size: 0.75rem;
        margin-top: 0.3rem;
        text-align: center;
      }

      .convert-btn {
        margin-top: 0.5rem;
        padding: 0.875rem;
        font-size: 0.95rem;
      }

      .result {
        margin-top: 1rem;
        padding-top: 1rem;
      }

      .result-row {
        padding: 0.6rem 0;
      }

      .result-label {
        font-size: 0.65rem;
      }

      .result-value {
        font-size: 0.9rem;
      }

      .result-value.highlight {
        font-size: 1rem;
      }

      footer {
        margin-top: 0.75rem;
        padding-top: 0.75rem;
        gap: 0.5rem;
        flex-shrink: 0;
      }

      .detected-tz {
        font-size: 0.7rem;
      }

      .theme-toggle {
        padding: 0.4rem 0.75rem;
        font-size: 0.65rem;
      }
    }
  </style>
</head>
<body>
  <div class="header-band"></div>

  <div class="container">
    <header>
      <h1>UTC Hack</h1>
    </header>

    <div class="clocks-strip">
      <div class="clock-item">
        <div class="clock-label">UTC</div>
        <div class="clock-time" id="utc-clock">--:--:--</div>
      </div>
      <div class="clock-item local">
        <div class="clock-label">Local</div>
        <div class="clock-time" id="local-clock">--:--:--</div>
      </div>
    </div>

    <div class="card">
      <div class="card-corner-tl"></div>
      <div class="card-corner-br"></div>
      <h2 class="card-title">Time Converter</h2>
      <div class="direction-toggle">
        <button class="direction-btn active" data-direction="toLocal" onclick="setDirection('toLocal')">
          UTC ‚Üí Local Time
        </button>
        <button class="direction-btn" data-direction="toUTC" onclick="setDirection('toUTC')">
          Local Time ‚Üí UTC
        </button>
      </div>

      <div class="step">
        <div class="step-header">
          <span class="step-number">1</span>
          <span class="step-label" id="time-step-label">Enter UTC Date & Time</span>
        </div>
        <input type="datetime-local" id="time-input">
      </div>

      <div class="step">
        <div class="step-header">
          <span class="step-number">2</span>
          <span class="step-label">Enter Location (any city or town)</span>
        </div>
        <input type="text" id="location-input" placeholder="e.g., Lincoln, Montana or Missoula, MT">
        <div class="location-feedback" id="location-feedback"></div>
      </div>

      <button class="convert-btn" id="convert-btn" onclick="convert()">Convert</button>

      <div class="result" id="result">
        <div class="result-row">
          <div class="result-label">Location</div>
          <div class="result-value" id="result-location">‚Äî</div>
        </div>
        <div class="result-row">
          <div class="result-label">Timezone</div>
          <div class="result-value" id="result-timezone">‚Äî</div>
        </div>
        <div class="result-row">
          <div class="result-label" id="result-utc-label">UTC Time</div>
          <div class="result-value" id="result-utc">‚Äî</div>
        </div>
        <div class="result-row">
          <div class="result-label" id="result-local-label">Local Time</div>
          <div class="result-value highlight" id="result-local">‚Äî</div>
        </div>
      </div>
    </div>

    <footer>
      <p class="detected-tz">Your detected timezone: <span id="user-tz"></span></p>
      <button class="theme-toggle" onclick="toggleTheme()">
        <span id="theme-icon">‚òÄÔ∏è</span>
        <span id="theme-label">Light</span>
      </button>
    </footer>
  </div>

  <script>
    // Translations for all supported languages
    const translations = {
      en: {
        timeConverter: 'Time Converter',
        utc: 'UTC',
        local: 'Local',
        utcToLocal: 'UTC ‚Üí Local Time',
        localToUtc: 'Local Time ‚Üí UTC',
        enterUtcDateTime: 'Enter UTC Date & Time',
        enterLocalDateTime: 'Enter Local Date & Time',
        enterLocation: 'Enter Location (any city or town)',
        locationPlaceholder: 'e.g., Lincoln, Montana or Missoula, MT',
        convert: 'Convert',
        location: 'Location',
        timezone: 'Timezone',
        utcTime: 'UTC Time',
        localTime: 'Local Time',
        utcTimeInput: 'UTC Time (input)',
        localTimeResult: 'Local Time (result)',
        utcTimeResult: 'UTC Time (result)',
        localTimeInput: 'Local Time (input)',
        detectedTimezone: 'Your detected timezone:',
        light: 'Light',
        dark: 'Dark',
        lookingUp: 'Looking up...',
        locationNotFound: 'Location not found',
        lookupFailed: 'Lookup failed ‚Äî try again',
        dst: 'DST',
        noDst: 'No DST'
      },
      de: {
        timeConverter: 'Zeitumrechner',
        utc: 'UTC',
        local: 'Lokal',
        utcToLocal: 'UTC ‚Üí Ortszeit',
        localToUtc: 'Ortszeit ‚Üí UTC',
        enterUtcDateTime: 'UTC-Datum & Zeit eingeben',
        enterLocalDateTime: 'Lokales Datum & Zeit eingeben',
        enterLocation: 'Ort eingeben (Stadt oder Gemeinde)',
        locationPlaceholder: 'z.B. Berlin, M√ºnchen oder Frankfurt',
        convert: 'Umrechnen',
        location: 'Ort',
        timezone: 'Zeitzone',
        utcTime: 'UTC-Zeit',
        localTime: 'Ortszeit',
        utcTimeInput: 'UTC-Zeit (Eingabe)',
        localTimeResult: 'Ortszeit (Ergebnis)',
        utcTimeResult: 'UTC-Zeit (Ergebnis)',
        localTimeInput: 'Ortszeit (Eingabe)',
        detectedTimezone: 'Erkannte Zeitzone:',
        light: 'Hell',
        dark: 'Dunkel',
        lookingUp: 'Suche...',
        locationNotFound: 'Ort nicht gefunden',
        lookupFailed: 'Suche fehlgeschlagen',
        dst: 'Sommerzeit',
        noDst: 'Keine Sommerzeit'
      },
      fr: {
        timeConverter: 'Convertisseur horaire',
        utc: 'UTC',
        local: 'Local',
        utcToLocal: 'UTC ‚Üí Heure locale',
        localToUtc: 'Heure locale ‚Üí UTC',
        enterUtcDateTime: 'Entrer date et heure UTC',
        enterLocalDateTime: 'Entrer date et heure locale',
        enterLocation: 'Entrer un lieu (ville)',
        locationPlaceholder: 'ex: Paris, Lyon ou Marseille',
        convert: 'Convertir',
        location: 'Lieu',
        timezone: 'Fuseau horaire',
        utcTime: 'Heure UTC',
        localTime: 'Heure locale',
        utcTimeInput: 'Heure UTC (entr√©e)',
        localTimeResult: 'Heure locale (r√©sultat)',
        utcTimeResult: 'Heure UTC (r√©sultat)',
        localTimeInput: 'Heure locale (entr√©e)',
        detectedTimezone: 'Fuseau horaire d√©tect√©:',
        light: 'Clair',
        dark: 'Sombre',
        lookingUp: 'Recherche...',
        locationNotFound: 'Lieu non trouv√©',
        lookupFailed: '√âchec de la recherche',
        dst: 'Heure d\'√©t√©',
        noDst: 'Pas d\'heure d\'√©t√©'
      },
      es: {
        timeConverter: 'Convertidor horario',
        utc: 'UTC',
        local: 'Local',
        utcToLocal: 'UTC ‚Üí Hora local',
        localToUtc: 'Hora local ‚Üí UTC',
        enterUtcDateTime: 'Ingrese fecha y hora UTC',
        enterLocalDateTime: 'Ingrese fecha y hora local',
        enterLocation: 'Ingrese ubicaci√≥n (ciudad)',
        locationPlaceholder: 'ej: Madrid, M√©xico DF o Buenos Aires',
        convert: 'Convertir',
        location: 'Ubicaci√≥n',
        timezone: 'Zona horaria',
        utcTime: 'Hora UTC',
        localTime: 'Hora local',
        utcTimeInput: 'Hora UTC (entrada)',
        localTimeResult: 'Hora local (resultado)',
        utcTimeResult: 'Hora UTC (resultado)',
        localTimeInput: 'Hora local (entrada)',
        detectedTimezone: 'Zona horaria detectada:',
        light: 'Claro',
        dark: 'Oscuro',
        lookingUp: 'Buscando...',
        locationNotFound: 'Ubicaci√≥n no encontrada',
        lookupFailed: 'Error en la b√∫squeda',
        dst: 'Horario de verano',
        noDst: 'Sin horario de verano'
      },
      pt: {
        timeConverter: 'Conversor de hor√°rio',
        utc: 'UTC',
        local: 'Local',
        utcToLocal: 'UTC ‚Üí Hora local',
        localToUtc: 'Hora local ‚Üí UTC',
        enterUtcDateTime: 'Digite data e hora UTC',
        enterLocalDateTime: 'Digite data e hora local',
        enterLocation: 'Digite localiza√ß√£o (cidade)',
        locationPlaceholder: 'ex: S√£o Paulo, Rio de Janeiro ou Bras√≠lia',
        convert: 'Converter',
        location: 'Localiza√ß√£o',
        timezone: 'Fuso hor√°rio',
        utcTime: 'Hora UTC',
        localTime: 'Hora local',
        utcTimeInput: 'Hora UTC (entrada)',
        localTimeResult: 'Hora local (resultado)',
        utcTimeResult: 'Hora UTC (resultado)',
        localTimeInput: 'Hora local (entrada)',
        detectedTimezone: 'Fuso hor√°rio detectado:',
        light: 'Claro',
        dark: 'Escuro',
        lookingUp: 'Procurando...',
        locationNotFound: 'Local n√£o encontrado',
        lookupFailed: 'Falha na busca',
        dst: 'Hor√°rio de ver√£o',
        noDst: 'Sem hor√°rio de ver√£o'
      },
      it: {
        timeConverter: 'Convertitore orario',
        utc: 'UTC',
        local: 'Locale',
        utcToLocal: 'UTC ‚Üí Ora locale',
        localToUtc: 'Ora locale ‚Üí UTC',
        enterUtcDateTime: 'Inserisci data e ora UTC',
        enterLocalDateTime: 'Inserisci data e ora locale',
        enterLocation: 'Inserisci localit√† (citt√†)',
        locationPlaceholder: 'es: Roma, Milano o Napoli',
        convert: 'Converti',
        location: 'Localit√†',
        timezone: 'Fuso orario',
        utcTime: 'Ora UTC',
        localTime: 'Ora locale',
        utcTimeInput: 'Ora UTC (input)',
        localTimeResult: 'Ora locale (risultato)',
        utcTimeResult: 'Ora UTC (risultato)',
        localTimeInput: 'Ora locale (input)',
        detectedTimezone: 'Fuso orario rilevato:',
        light: 'Chiaro',
        dark: 'Scuro',
        lookingUp: 'Ricerca...',
        locationNotFound: 'Localit√† non trovata',
        lookupFailed: 'Ricerca fallita',
        dst: 'Ora legale',
        noDst: 'Nessuna ora legale'
      },
      pl: {
        timeConverter: 'Konwerter czasu',
        utc: 'UTC',
        local: 'Lokalny',
        utcToLocal: 'UTC ‚Üí Czas lokalny',
        localToUtc: 'Czas lokalny ‚Üí UTC',
        enterUtcDateTime: 'Wprowad≈∫ datƒô i czas UTC',
        enterLocalDateTime: 'Wprowad≈∫ lokalnƒÖ datƒô i czas',
        enterLocation: 'Wprowad≈∫ lokalizacjƒô (miasto)',
        locationPlaceholder: 'np. Warszawa, Krak√≥w lub Gda≈Ñsk',
        convert: 'Konwertuj',
        location: 'Lokalizacja',
        timezone: 'Strefa czasowa',
        utcTime: 'Czas UTC',
        localTime: 'Czas lokalny',
        utcTimeInput: 'Czas UTC (wej≈õcie)',
        localTimeResult: 'Czas lokalny (wynik)',
        utcTimeResult: 'Czas UTC (wynik)',
        localTimeInput: 'Czas lokalny (wej≈õcie)',
        detectedTimezone: 'Wykryta strefa czasowa:',
        light: 'Jasny',
        dark: 'Ciemny',
        lookingUp: 'Szukam...',
        locationNotFound: 'Nie znaleziono lokalizacji',
        lookupFailed: 'Wyszukiwanie nie powiod≈Ço siƒô',
        dst: 'Czas letni',
        noDst: 'Bez czasu letniego'
      },
      nl: {
        timeConverter: 'Tijdconverter',
        utc: 'UTC',
        local: 'Lokaal',
        utcToLocal: 'UTC ‚Üí Lokale tijd',
        localToUtc: 'Lokale tijd ‚Üí UTC',
        enterUtcDateTime: 'Voer UTC-datum en tijd in',
        enterLocalDateTime: 'Voer lokale datum en tijd in',
        enterLocation: 'Voer locatie in (stad)',
        locationPlaceholder: 'bijv. Amsterdam, Rotterdam of Utrecht',
        convert: 'Converteren',
        location: 'Locatie',
        timezone: 'Tijdzone',
        utcTime: 'UTC-tijd',
        localTime: 'Lokale tijd',
        utcTimeInput: 'UTC-tijd (invoer)',
        localTimeResult: 'Lokale tijd (resultaat)',
        utcTimeResult: 'UTC-tijd (resultaat)',
        localTimeInput: 'Lokale tijd (invoer)',
        detectedTimezone: 'Gedetecteerde tijdzone:',
        light: 'Licht',
        dark: 'Donker',
        lookingUp: 'Zoeken...',
        locationNotFound: 'Locatie niet gevonden',
        lookupFailed: 'Zoeken mislukt',
        dst: 'Zomertijd',
        noDst: 'Geen zomertijd'
      },
      ru: {
        timeConverter: '–ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä –≤—Ä–µ–º–µ–Ω–∏',
        utc: 'UTC',
        local: '–ú–µ—Å—Ç–Ω–æ–µ',
        utcToLocal: 'UTC ‚Üí –ú–µ—Å—Ç–Ω–æ–µ –≤—Ä–µ–º—è',
        localToUtc: '–ú–µ—Å—Ç–Ω–æ–µ –≤—Ä–µ–º—è ‚Üí UTC',
        enterUtcDateTime: '–í–≤–µ–¥–∏—Ç–µ –¥–∞—Ç—É –∏ –≤—Ä–µ–º—è UTC',
        enterLocalDateTime: '–í–≤–µ–¥–∏—Ç–µ –º–µ—Å—Ç–Ω—É—é –¥–∞—Ç—É –∏ –≤—Ä–µ–º—è',
        enterLocation: '–í–≤–µ–¥–∏—Ç–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ (–≥–æ—Ä–æ–¥)',
        locationPlaceholder: '–Ω–∞–ø—Ä. –ú–æ—Å–∫–≤–∞, –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥',
        convert: '–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å',
        location: '–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ',
        timezone: '–ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å',
        utcTime: '–í—Ä–µ–º—è UTC',
        localTime: '–ú–µ—Å—Ç–Ω–æ–µ –≤—Ä–µ–º—è',
        utcTimeInput: '–í—Ä–µ–º—è UTC (–≤–≤–æ–¥)',
        localTimeResult: '–ú–µ—Å—Ç–Ω–æ–µ –≤—Ä–µ–º—è (—Ä–µ–∑—É–ª—å—Ç–∞—Ç)',
        utcTimeResult: '–í—Ä–µ–º—è UTC (—Ä–µ–∑—É–ª—å—Ç–∞—Ç)',
        localTimeInput: '–ú–µ—Å—Ç–Ω–æ–µ –≤—Ä–µ–º—è (–≤–≤–æ–¥)',
        detectedTimezone: '–û–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–π —á–∞—Å–æ–≤–æ–π –ø–æ—è—Å:',
        light: '–°–≤–µ—Ç–ª–∞—è',
        dark: '–¢—ë–º–Ω–∞—è',
        lookingUp: '–ü–æ–∏—Å–∫...',
        locationNotFound: '–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ',
        lookupFailed: '–û—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞',
        dst: '–õ–µ—Ç–Ω–µ–µ –≤—Ä–µ–º—è',
        noDst: '–ë–µ–∑ –ª–µ—Ç–Ω–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏'
      },
      ja: {
        timeConverter: 'ÊôÇÈñìÂ§âÊèõ',
        utc: 'UTC',
        local: 'ÁèæÂú∞',
        utcToLocal: 'UTC ‚Üí ÁèæÂú∞ÊôÇÈñì',
        localToUtc: 'ÁèæÂú∞ÊôÇÈñì ‚Üí UTC',
        enterUtcDateTime: 'UTCÊó•ÊôÇ„ÇíÂÖ•Âäõ',
        enterLocalDateTime: 'ÁèæÂú∞Êó•ÊôÇ„ÇíÂÖ•Âäõ',
        enterLocation: 'Â†¥ÊâÄ„ÇíÂÖ•ÂäõÔºàÈÉΩÂ∏ÇÂêçÔºâ',
        locationPlaceholder: '‰æãÔºöÊù±‰∫¨„ÄÅÂ§ßÈò™„ÄÅÂêçÂè§Â±ã',
        convert: 'Â§âÊèõ',
        location: 'Â†¥ÊâÄ',
        timezone: '„Çø„Ç§„É†„Çæ„Éº„É≥',
        utcTime: 'UTCÊôÇÈñì',
        localTime: 'ÁèæÂú∞ÊôÇÈñì',
        utcTimeInput: 'UTCÊôÇÈñìÔºàÂÖ•ÂäõÔºâ',
        localTimeResult: 'ÁèæÂú∞ÊôÇÈñìÔºàÁµêÊûúÔºâ',
        utcTimeResult: 'UTCÊôÇÈñìÔºàÁµêÊûúÔºâ',
        localTimeInput: 'ÁèæÂú∞ÊôÇÈñìÔºàÂÖ•ÂäõÔºâ',
        detectedTimezone: 'Ê§úÂá∫„Åï„Çå„Åü„Çø„Ç§„É†„Çæ„Éº„É≥Ôºö',
        light: '„É©„Ç§„Éà',
        dark: '„ÉÄ„Éº„ÇØ',
        lookingUp: 'Ê§úÁ¥¢‰∏≠...',
        locationNotFound: 'Â†¥ÊâÄ„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì',
        lookupFailed: 'Ê§úÁ¥¢„Å´Â§±Êïó„Åó„Åæ„Åó„Åü',
        dst: 'Â§èÊôÇÈñì',
        noDst: 'Â§èÊôÇÈñì„Å™„Åó'
      },
      zh: {
        timeConverter: 'Êó∂Èó¥ËΩ¨Êç¢Âô®',
        utc: 'UTC',
        local: 'Êú¨Âú∞',
        utcToLocal: 'UTC ‚Üí Êú¨Âú∞Êó∂Èó¥',
        localToUtc: 'Êú¨Âú∞Êó∂Èó¥ ‚Üí UTC',
        enterUtcDateTime: 'ËæìÂÖ•UTCÊó•ÊúüÂíåÊó∂Èó¥',
        enterLocalDateTime: 'ËæìÂÖ•Êú¨Âú∞Êó•ÊúüÂíåÊó∂Èó¥',
        enterLocation: 'ËæìÂÖ•‰ΩçÁΩÆÔºàÂüéÂ∏ÇÔºâ',
        locationPlaceholder: '‰æãÂ¶ÇÔºöÂåó‰∫¨„ÄÅ‰∏äÊµ∑„ÄÅÂπøÂ∑û',
        convert: 'ËΩ¨Êç¢',
        location: '‰ΩçÁΩÆ',
        timezone: 'Êó∂Âå∫',
        utcTime: 'UTCÊó∂Èó¥',
        localTime: 'Êú¨Âú∞Êó∂Èó¥',
        utcTimeInput: 'UTCÊó∂Èó¥ÔºàËæìÂÖ•Ôºâ',
        localTimeResult: 'Êú¨Âú∞Êó∂Èó¥ÔºàÁªìÊûúÔºâ',
        utcTimeResult: 'UTCÊó∂Èó¥ÔºàÁªìÊûúÔºâ',
        localTimeInput: 'Êú¨Âú∞Êó∂Èó¥ÔºàËæìÂÖ•Ôºâ',
        detectedTimezone: 'Ê£ÄÊµãÂà∞ÁöÑÊó∂Âå∫Ôºö',
        light: 'ÊµÖËâ≤',
        dark: 'Ê∑±Ëâ≤',
        lookingUp: 'ÊêúÁ¥¢‰∏≠...',
        locationNotFound: 'Êú™ÊâæÂà∞‰ΩçÁΩÆ',
        lookupFailed: 'ÊêúÁ¥¢Â§±Ë¥•',
        dst: 'Â§è‰ª§Êó∂',
        noDst: 'Êó†Â§è‰ª§Êó∂'
      },
      ko: {
        timeConverter: 'ÏãúÍ∞Ñ Î≥ÄÌôòÍ∏∞',
        utc: 'UTC',
        local: 'ÌòÑÏßÄ',
        utcToLocal: 'UTC ‚Üí ÌòÑÏßÄ ÏãúÍ∞Ñ',
        localToUtc: 'ÌòÑÏßÄ ÏãúÍ∞Ñ ‚Üí UTC',
        enterUtcDateTime: 'UTC ÎÇ†Ïßú Î∞è ÏãúÍ∞Ñ ÏûÖÎ†•',
        enterLocalDateTime: 'ÌòÑÏßÄ ÎÇ†Ïßú Î∞è ÏãúÍ∞Ñ ÏûÖÎ†•',
        enterLocation: 'ÏúÑÏπò ÏûÖÎ†• (ÎèÑÏãú)',
        locationPlaceholder: 'Ïòà: ÏÑúÏö∏, Î∂ÄÏÇ∞, Ïù∏Ï≤ú',
        convert: 'Î≥ÄÌôò',
        location: 'ÏúÑÏπò',
        timezone: 'ÏãúÍ∞ÑÎåÄ',
        utcTime: 'UTC ÏãúÍ∞Ñ',
        localTime: 'ÌòÑÏßÄ ÏãúÍ∞Ñ',
        utcTimeInput: 'UTC ÏãúÍ∞Ñ (ÏûÖÎ†•)',
        localTimeResult: 'ÌòÑÏßÄ ÏãúÍ∞Ñ (Í≤∞Í≥º)',
        utcTimeResult: 'UTC ÏãúÍ∞Ñ (Í≤∞Í≥º)',
        localTimeInput: 'ÌòÑÏßÄ ÏãúÍ∞Ñ (ÏûÖÎ†•)',
        detectedTimezone: 'Í∞êÏßÄÎêú ÏãúÍ∞ÑÎåÄ:',
        light: 'ÎùºÏù¥Ìä∏',
        dark: 'Îã§ÌÅ¨',
        lookingUp: 'Í≤ÄÏÉâ Ï§ë...',
        locationNotFound: 'ÏúÑÏπòÎ•º Ï∞æÏùÑ Ïàò ÏóÜÏùå',
        lookupFailed: 'Í≤ÄÏÉâ Ïã§Ìå®',
        dst: 'ÏùºÍ¥ë Ï†àÏïΩ ÏãúÍ∞Ñ',
        noDst: 'ÏùºÍ¥ë Ï†àÏïΩ ÏãúÍ∞Ñ ÏóÜÏùå'
      },
      ar: {
        timeConverter: 'ŸÖÿ≠ŸàŸÑ ÿßŸÑŸàŸÇÿ™',
        utc: 'UTC',
        local: 'ŸÖÿ≠ŸÑŸä',
        utcToLocal: 'UTC ‚Üê ÿßŸÑŸàŸÇÿ™ ÿßŸÑŸÖÿ≠ŸÑŸä',
        localToUtc: 'ÿßŸÑŸàŸÇÿ™ ÿßŸÑŸÖÿ≠ŸÑŸä ‚Üê UTC',
        enterUtcDateTime: 'ÿ£ÿØÿÆŸÑ ÿ™ÿßÿ±ŸäÿÆ ŸàŸàŸÇÿ™ UTC',
        enterLocalDateTime: 'ÿ£ÿØÿÆŸÑ ÿßŸÑÿ™ÿßÿ±ŸäÿÆ ŸàÿßŸÑŸàŸÇÿ™ ÿßŸÑŸÖÿ≠ŸÑŸä',
        enterLocation: 'ÿ£ÿØÿÆŸÑ ÿßŸÑŸÖŸàŸÇÿπ (ÿßŸÑŸÖÿØŸäŸÜÿ©)',
        locationPlaceholder: 'ŸÖÿ´ÿßŸÑ: ÿØÿ®Ÿäÿå ÿßŸÑÿ±Ÿäÿßÿ∂ÿå ÿßŸÑŸÇÿßŸáÿ±ÿ©',
        convert: 'ÿ™ÿ≠ŸàŸäŸÑ',
        location: 'ÿßŸÑŸÖŸàŸÇÿπ',
        timezone: 'ÿßŸÑŸÖŸÜÿ∑ŸÇÿ© ÿßŸÑÿ≤ŸÖŸÜŸäÿ©',
        utcTime: 'ŸàŸÇÿ™ UTC',
        localTime: 'ÿßŸÑŸàŸÇÿ™ ÿßŸÑŸÖÿ≠ŸÑŸä',
        utcTimeInput: 'ŸàŸÇÿ™ UTC (ÿ•ÿØÿÆÿßŸÑ)',
        localTimeResult: 'ÿßŸÑŸàŸÇÿ™ ÿßŸÑŸÖÿ≠ŸÑŸä (ÿßŸÑŸÜÿ™Ÿäÿ¨ÿ©)',
        utcTimeResult: 'ŸàŸÇÿ™ UTC (ÿßŸÑŸÜÿ™Ÿäÿ¨ÿ©)',
        localTimeInput: 'ÿßŸÑŸàŸÇÿ™ ÿßŸÑŸÖÿ≠ŸÑŸä (ÿ•ÿØÿÆÿßŸÑ)',
        detectedTimezone: 'ÿßŸÑŸÖŸÜÿ∑ŸÇÿ© ÿßŸÑÿ≤ŸÖŸÜŸäÿ© ÿßŸÑŸÖŸÉÿ™ÿ¥ŸÅÿ©:',
        light: 'ŸÅÿßÿ™ÿ≠',
        dark: 'ÿØÿßŸÉŸÜ',
        lookingUp: 'ÿ¨ÿßÿ±Ÿä ÿßŸÑÿ®ÿ≠ÿ´...',
        locationNotFound: 'ÿßŸÑŸÖŸàŸÇÿπ ÿ∫Ÿäÿ± ŸÖŸàÿ¨ŸàÿØ',
        lookupFailed: 'ŸÅÿ¥ŸÑ ÿßŸÑÿ®ÿ≠ÿ´',
        dst: 'ÿßŸÑÿ™ŸàŸÇŸäÿ™ ÿßŸÑÿµŸäŸÅŸä',
        noDst: 'ÿ®ÿØŸàŸÜ ÿ™ŸàŸÇŸäÿ™ ÿµŸäŸÅŸä'
      }
    };

    // Detect language from URL path
    const supportedLangs = ['en', 'de', 'fr', 'es', 'pt', 'it', 'pl', 'nl', 'ru', 'ja', 'zh', 'ko', 'ar'];
    const pathLang = window.location.pathname.split('/')[1];
    const currentLang = supportedLangs.includes(pathLang) ? pathLang : 'en';
    const t = translations[currentLang];

    // State
    let currentDirection = 'toLocal';
    let resolvedTimezone = null;
    let resolvedDisplayName = null;
    const userTimezone = Intl.DateTimeFormat().resolvedOptions().timeZone;

    // Apply translations to the page
    function applyTranslations() {
      // Static elements
      document.querySelector('.card-title').textContent = t.timeConverter;
      document.querySelector('.clock-item:first-child .clock-label').textContent = t.utc;
      document.querySelector('.clock-item.local .clock-label').textContent = t.local;
      document.querySelector('[data-direction="toLocal"]').textContent = t.utcToLocal;
      document.querySelector('[data-direction="toUTC"]').textContent = t.localToUtc;
      document.getElementById('time-step-label').textContent = t.enterUtcDateTime;
      document.querySelector('.step:nth-child(3) .step-label').textContent = t.enterLocation;
      document.getElementById('location-input').placeholder = t.locationPlaceholder;
      document.getElementById('convert-btn').textContent = t.convert;
      document.querySelector('.result-row:nth-child(1) .result-label').textContent = t.location;
      document.querySelector('.result-row:nth-child(2) .result-label').textContent = t.timezone;
      document.getElementById('result-utc-label').textContent = t.utcTime;
      document.getElementById('result-local-label').textContent = t.localTime;
      document.querySelector('.detected-tz').firstChild.textContent = t.detectedTimezone + ' ';
      document.getElementById('theme-label').textContent = t.light;

      // Set HTML lang attribute
      document.documentElement.lang = currentLang;

      // Set text direction for Arabic
      if (currentLang === 'ar') {
        document.documentElement.dir = 'rtl';
      }
    }

    // Initialize
    document.addEventListener('DOMContentLoaded', () => {
      applyTranslations();
      document.getElementById('user-tz').textContent = userTimezone;
      updateClocks();
      setInterval(updateClocks, 1000);
      setDefaultTime();

      // Load saved theme
      const savedTheme = localStorage.getItem('theme') || 'light';
      setTheme(savedTheme);

      // Location input with debounce
      document.getElementById('location-input').addEventListener('input', debounce(lookupLocation, 400));
    });

    function updateClocks() {
      const now = new Date();
      document.getElementById('utc-clock').textContent = now.toLocaleTimeString('en-US', {
        timeZone: 'UTC', hour12: false, hour: '2-digit', minute: '2-digit', second: '2-digit'
      });
      document.getElementById('local-clock').textContent = now.toLocaleTimeString('en-US', {
        hour12: false, hour: '2-digit', minute: '2-digit', second: '2-digit'
      });
    }

    function setDefaultTime() {
      const now = new Date();
      document.getElementById('time-input').value = now.toISOString().slice(0, 16);
    }

    function setDirection(dir) {
      currentDirection = dir;
      document.querySelectorAll('.direction-btn').forEach(btn => {
        btn.classList.toggle('active', btn.dataset.direction === dir);
      });

      // Update labels
      const timeLabel = document.getElementById('time-step-label');
      const resultUtcLabel = document.getElementById('result-utc-label');
      const resultLocalLabel = document.getElementById('result-local-label');

      if (dir === 'toLocal') {
        timeLabel.textContent = t.enterUtcDateTime;
        resultUtcLabel.textContent = t.utcTimeInput;
        resultLocalLabel.textContent = t.localTimeResult;
      } else {
        timeLabel.textContent = t.enterLocalDateTime;
        resultUtcLabel.textContent = t.utcTimeResult;
        resultLocalLabel.textContent = t.localTimeInput;
      }

      // Clear previous result
      document.getElementById('result').classList.remove('visible');
    }

    async function lookupLocation() {
      const input = document.getElementById('location-input').value.trim();
      const feedback = document.getElementById('location-feedback');

      if (!input) {
        feedback.textContent = '';
        feedback.className = 'location-feedback';
        resolvedTimezone = null;
        return;
      }

      feedback.textContent = t.lookingUp;
      feedback.className = 'location-feedback loading';

      try {
        const res = await fetch(`/api/location?q=${encodeURIComponent(input)}`);
        const data = await res.json();

        if (data.timezone) {
          resolvedTimezone = data.timezone;
          resolvedDisplayName = data.displayName;
          feedback.textContent = `‚úì ${data.timezone} (${data.tzAbbreviation})`;
          feedback.className = 'location-feedback success';
        } else {
          resolvedTimezone = null;
          feedback.textContent = t.locationNotFound;
          feedback.className = 'location-feedback error';
        }
      } catch (e) {
        resolvedTimezone = null;
        feedback.textContent = t.lookupFailed;
        feedback.className = 'location-feedback error';
      }
    }

    async function convert() {
      const timeInput = document.getElementById('time-input').value;

      if (!timeInput) {
        alert('Please enter a date and time');
        return;
      }

      if (!resolvedTimezone) {
        alert('Please enter a valid location');
        return;
      }

      try {
        const res = await fetch('/api/convert', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            time: timeInput,
            timezone: resolvedTimezone,
            direction: currentDirection
          })
        });

        const data = await res.json();

        if (data.error) {
          alert(data.error);
          return;
        }

        // Populate results
        document.getElementById('result-location').textContent = shortenDisplayName(resolvedDisplayName);

        let tzDisplay = `${data.timezone} (${data.tzAbbreviation})`;
        if (data.isDST) {
          tzDisplay += '<span class="dst-indicator active">DST</span>';
        } else if (resolvedTimezone === 'America/Phoenix') {
          tzDisplay += '<span class="dst-indicator inactive">No DST</span>';
        }
        document.getElementById('result-timezone').innerHTML = tzDisplay;

        document.getElementById('result-utc').textContent = data.utcFormatted;
        document.getElementById('result-local').textContent = data.localFormatted;

        // Highlight the result based on direction
        const utcEl = document.getElementById('result-utc');
        const localEl = document.getElementById('result-local');

        if (currentDirection === 'toLocal') {
          utcEl.classList.remove('highlight');
          localEl.classList.add('highlight');
        } else {
          localEl.classList.remove('highlight');
          utcEl.classList.add('highlight');
        }

        document.getElementById('result').classList.add('visible');
      } catch (e) {
        alert('Conversion failed');
      }
    }

    function shortenDisplayName(name) {
      if (!name) return '‚Äî';
      // Take first two parts (city, state/country)
      const parts = name.split(', ');
      return parts.slice(0, 2).join(', ');
    }

    function toggleTheme() {
      const html = document.documentElement;
      const current = html.getAttribute('data-theme');
      const next = current === 'light' ? 'dark' : 'light';
      setTheme(next);
      localStorage.setItem('theme', next);
    }

    function setTheme(theme) {
      document.documentElement.setAttribute('data-theme', theme);
      document.getElementById('theme-icon').textContent = theme === 'light' ? '‚òÄÔ∏è' : 'üåô';
      document.getElementById('theme-label').textContent = theme === 'light' ? t.light : t.dark;
    }

    function debounce(func, wait) {
      let timeout;
      return function(...args) {
        clearTimeout(timeout);
        timeout = setTimeout(() => func.apply(this, args), wait);
      };
    }

    // Register service worker for PWA
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('/sw.js').catch(() => {});
    }

    // Pull to refresh
    let touchStartY = 0;
    let isPulling = false;
    let isRefreshing = false;

    function getScrollTop() {
      return window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0;
    }

    document.addEventListener('touchstart', (e) => {
      if (getScrollTop() <= 0 && !isRefreshing) {
        touchStartY = e.touches[0].clientY;
        isPulling = true;
      }
    }, { passive: true });

    document.addEventListener('touchmove', (e) => {
      if (!isPulling || isRefreshing) return;
      const touchY = e.touches[0].clientY;
      const pullDistance = touchY - touchStartY;
      if (pullDistance > 100 && getScrollTop() <= 0) {
        isPulling = false;
        isRefreshing = true;
        document.body.style.transition = 'opacity 0.2s ease';
        document.body.style.opacity = '0.5';
        setTimeout(() => location.reload(), 200);
      }
    }, { passive: true });

    document.addEventListener('touchend', () => {
      isPulling = false;
    });
  </script>
</body>
</html>
